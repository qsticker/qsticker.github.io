(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69c0dcf9"],{"0786":function(e,t,a){"use strict";var i=a("6062"),s=a.n(i);s.a},"0e1f":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"guided-tour-item"},[a("div",{staticClass:"block",style:{"margin-top":e.marginTop+"px"}},[a("div",{staticClass:"area",class:{marginAuto:e.marginAuto,useBorder:e.useBorder},style:{height:e.height+"px",width:e.width+"%"}}),a("div",{staticClass:"txt",style:{bottom:e.txtBottom+"%",right:e.txtRight+"%",left:e.txtLeft+"%"}},[a("h4",[e._v(e._s(e.label)+" "+e._s(e.title))]),a("p",[e._v(e._s(e.content))])])])])},s=[],n=(a("a9e3"),a("2b0e")),r=n["default"].extend({components:{},props:{useBorder:{type:Boolean,required:!1,default:!0},marginTop:{type:Number,required:!1,default:40},marginAuto:{type:Boolean,required:!1,default:!1},height:{type:Number,required:!1,default:100},width:{type:Number,required:!1,default:100},txtBottom:{type:Number,required:!1,default:-80},txtRight:{type:Number,required:!1,default:0},label:{type:String,required:!1,default:""},title:{type:String,required:!1,default:""},content:{type:String,required:!1,default:""},txtLeft:{type:Number,required:!1,default:0}},data:function(){return{}},computed:{},methods:{}}),l=r,d=(a("87ca"),a("2877")),u=Object(d["a"])(l,i,s,!1,null,"e6b3e420",null);t["a"]=u.exports},"20ca":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"checked-items"},["video"===e.groupType?a("h2",[e._v(" "+e._s(e.$t("影片連結"))+" ")]):a("h2",[e._v(" "+e._s(e.$t("已選項目"))+" ")]),"member"===e.groupType?a("div",{staticClass:"content"},e._l(e.checkedList,(function(t){return a("div",{key:t.uuid,staticClass:"item"},["WorkspaceFolder"===t.metadata.type?a("div",{staticClass:"item-area"},[a("div",[e._v(e._s(t.metadata.name))]),a("div",[e._v(e._s(e.$t("資料夾")))])]):e._e(),"WorkspaceMemberGroup"===t.metadata.type?a("div",{staticClass:"item-area"},[t.sourceObject?a("div",[e._v(" "+e._s(t.sourceObject.uniqueName)+" ")]):a("div",[e._v(" "+e._s(t.uniqueName)+" ")]),a("div",[e._v(e._s(e.$tc("n人",t.memberCount,{n:t.memberCount})))])]):e._e(),"WorkspaceSoftLink"===t.metadata.type?a("div",{staticClass:"item-area"},[a("div",[e._v(" "+e._s(t.sourceObject.uniqueName)+" "),a("i",{staticClass:"fas fa-user-friends shared-item"})]),"member"===e.groupType?a("div",[e._v(" "+e._s(e.$tc("n人",t.sourceObject.memberCount,{n:t.sourceObject.memberCount}))+" ")]):e._e()]):e._e()])})),0):e._e(),"quiz"===e.groupType?a("div",{staticClass:"content"},[a("div",[a("handle-draggable",{attrs:{"checked-list":e.checkedList,"group-type":e.groupType}})],1)]):e._e(),"video"===e.groupType?a("div",{staticClass:"content"},[a("div",[a("handle-draggable",{attrs:{"checked-list":e.checkedList}})],1)]):e._e()])},s=[],n=a("2b0e"),r=a("8198"),l=n["default"].extend({components:{HandleDraggable:r["a"]},props:{checkedList:{type:Array,default:function(){return[]}},groupType:{type:String,default:""}},data:function(){return{}},computed:{}}),d=l,u=(a("b771"),a("2877")),o=Object(u["a"])(d,i,s,!1,null,"7a835511",null);t["a"]=o.exports},"30fb":function(e,t,a){},"33e8":function(e,t,a){"use strict";var i=a("4fde"),s=a.n(i);s.a},"3a11":function(e,t,a){},"406b":function(e,t,a){},"443e":function(e,t,a){"use strict";var i=a("30fb"),s=a.n(i);s.a},4442:function(e,t,a){"use strict";var i=a("af88"),s=a.n(i);s.a},"4c77":function(e,t,a){},"4fde":function(e,t,a){},"52e1":function(e,t,a){"use strict";var i=a("dc93"),s=a.n(i);s.a},5870:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{staticClass:"modal-container",attrs:{name:"select-member-group-modal",transition:"pop-out",width:"640","focus-trap":!0,height:"640"},on:{"before-open":e.beforeOpen}},[e.memberLocalRootId&&e.memberShareRootId?a("WorkspaceObjectSelector",{attrs:{"local-root-id":e.memberLocalRootId,"share-root-id":e.memberShareRootId,"default-selection":e.defaultSelection,"local-root-name":e.$t(e.rootName),"allow-select-many":!0,"display-select-all-toggle":e.displaySelectAllToggle,"share-group-hidden":e.shareGroupHidden},on:{"submit-selection":e.handleSubmit,cancel:e.handleCancel}}):a("loading",{attrs:{active:!0,"is-full-page":!1,"background-color":"transparent"}})],1)},s=[],n=a("2b0e"),r=a("5da8"),l=n["default"].extend({components:{WorkspaceObjectSelector:r["a"]},props:{shareGroupHidden:{type:Boolean,default:!1}},data:function(){return{defaultSelection:[],rootName:"我的班級",displaySelectAllToggle:!0}},computed:{memberLocalRootId:function(){return this.$store.state.currentWorkspace?this.$store.state.currentWorkspace.memberFolders.local:null},memberShareRootId:function(){return this.$store.state.currentWorkspace?this.$store.state.currentWorkspace.memberFolders.share:null}},methods:{beforeOpen:function(e){e.params.defaultSelection&&(this.defaultSelection=e.params.defaultSelection)},handleSubmit:function(e){this.$emit("submit-selection",e),this.$modal.hide("select-member-group-modal")},handleCancel:function(){this.$modal.hide("select-member-group-modal")}}}),d=l,u=a("2877"),o=Object(u["a"])(d,i,s,!1,null,null,null);t["a"]=o.exports},"59f4":function(e,t,a){"use strict";var i=a("5eba"),s=a.n(i);s.a},"5eba":function(e,t,a){},6062:function(e,t,a){},"643a":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"guided-tour"},[a("div",{staticClass:"background"},[e._m(0),a("div",{staticClass:"close-btn",on:{click:e.closeGuidedTour}},[a("i",{staticClass:"far fa-times-circle"})])])])},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title pt-3"},[a("h1",[e._v("使用導覽")])])}],n=a("2b0e"),r=n["default"].extend({computed:{},methods:{closeGuidedTour:function(){this.$emit("setShowGuidedTour",!1)}}}),l=r,d=(a("33e8"),a("2877")),u=Object(d["a"])(l,i,s,!1,null,"f6943c30",null);t["a"]=u.exports},"66e7":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"event-maker"},[e.showGuidedTourItem?a("div",{staticClass:"guided-tour"},[a("GuidedTour",{on:{setShowGuidedTour:e.setShowGuidedTour}})],1):e._e(),a("div",{staticClass:"open-guided-tour-btn"},[a("OpenGuidedTourBtn",{on:{setShowGuidedTour:e.setShowGuidedTour}})],1),e.quizEvent?a("div",{staticClass:"container"},[a("div",{staticClass:"title"},[a("h2",[e._v(" "+e._s(e.$t("編輯測驗"))+" ")])]),a("div",{staticClass:"part basic"},[a("div",{staticClass:"title"},[a("h3",[e._v(" "+e._s(e.$t("基本設定"))+" ")])]),a("form",{staticClass:"info pl-4"},[a("div",{staticClass:"input-group"},[a("label",{attrs:{for:"quizEvent_name"}},[e._v(e._s(e.$t("測驗名稱")))]),a("div",{staticClass:"enter-area"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.quizEvent.metadata.name,expression:"quizEvent.metadata.name"}],attrs:{id:"quizEvent_name",type:"text"},domProps:{value:e.quizEvent.metadata.name},on:{input:function(t){t.target.composing||e.$set(e.quizEvent.metadata,"name",t.target.value)}}}),a("div",{staticClass:"remind"},[e._v(" * "+e._s(e.$t("此測驗名稱僅在此平台顯示，測驗邀請將會以題組名稱作為測驗名稱"))+" ")])])]),a("div",{staticClass:"input-group"},[a("label",{staticClass:"toggle-label"},[e._v(e._s(e.$t("開啟題號與選項亂序")))]),a("toggle-button",{staticClass:"toggle w-80",attrs:{color:"#82C7EB",sync:!0,labels:!0},model:{value:e.quizEvent.shuffle,callback:function(t){e.$set(e.quizEvent,"shuffle",t)},expression:"quizEvent.shuffle"}})],1),a("div",{staticClass:"retake input-group"},[a("label",{staticClass:"toggle-label"},[e._v(e._s(e.$t("開啟再測一次")))]),a("toggle-button",{staticClass:"toggle w-80",attrs:{color:"#82C7EB",sync:!0,labels:!0},model:{value:e.quizEvent.allowRetake,callback:function(t){e.$set(e.quizEvent,"allowRetake",t)},expression:"quizEvent.allowRetake"}})],1),a("div",{staticClass:"retake input-group"},[a("label",{staticClass:"toggle-label"},[e._v(e._s(e.$t("開啟眼球追蹤")))]),a("toggle-button",{staticClass:"toggle w-80",attrs:{color:"#82C7EB",sync:!0,labels:!0},model:{value:e.quizEvent.eyeballDetect,callback:function(t){e.$set(e.quizEvent,"eyeballDetect",t)},expression:"quizEvent.eyeballDetect"}})],1)]),e.showGuidedTourItem?a("div",{staticClass:"guided-tour"},[a("GuidedTourItem",{attrs:{height:110,label:"",title:"基本設定",content:"首先填寫測驗名稱，此名稱僅顯示於此平台辨認之用，測驗邀請將會使用題組名稱顯示"}})],1):e._e()]),a("div",{staticClass:"part memberGroup"},[a("div",{staticClass:"title"},[a("h3",[e._v(" "+e._s(e.$t("選擇班級"))+" ")])]),a("div",{staticClass:"forMembers"},[a("b-button",{on:{click:function(t){return t.preventDefault(),e.openSelectMemberGroupModal(t)}}},[e._v(" "+e._s(e.$t("選擇班級"))+" ")]),a("SelectMemberGroupModal",{on:{"submit-selection":e.updateSelectedMemberGroup}}),a("div",{staticClass:"checkfilterList"},[a("checkedItems",{attrs:{"checked-list":e.quizEvent.memberGroups,"group-type":e.memberGroupsInfo.name}})],1)],1),e.showGuidedTourItem?a("div",{staticClass:"guided-tour"},[a("GuidedTourItem",{attrs:{"margin-top":60,height:60,width:50,"txt-bottom":-120,label:"",title:"選擇班級",content:"可多選，並於右邊確認選項"}})],1):e._e()]),a("div",{staticClass:"part quizGroup"},[a("div",{staticClass:"title"},[a("h3",[e._v(" "+e._s(e.$t("選擇題組"))+" ")])]),a("div",{staticClass:"forQuestions"},[a("b-button",{on:{click:function(t){return t.preventDefault(),e.openSelectQuizGroupModal(t)}}},[e._v(" "+e._s(e.$t("選擇題組"))+" ")]),a("SelectQuizGroupModal",{on:{"submit-selection":e.updateSelectedQuizGroup}}),a("div",{staticClass:"checkfilterList"},[a("checkedItems",{attrs:{"checked-list":e.quizEvent.quizGroups,"group-type":e.quizGroupsInfo.name}})],1)],1),e.showGuidedTourItem?a("div",{staticClass:"guided-tour"},[a("GuidedTourItem",{attrs:{"margin-top":60,height:60,width:50,"txt-bottom":-120,label:"",title:"選擇題組",content:"可多選，並於右邊確認選項"}})],1):e._e()]),a("div",{staticClass:"part sendMode"},[a("div",{staticClass:"title"},[a("h3",[e._v(" "+e._s(e.$t("測驗發送模式"))+" ")])]),a("div",{staticClass:"send-mode-area"},[a("SendModeSetting",{attrs:{"quiz-event":e.quizEvent,"seleted-quiz-groups":e.quizEvent.quizGroups,"date-time":e.dateTime,"scheduled-time":e.dateTime.scheduledTime,"start-valid":e.dateTime.startValid,"end-valid":e.dateTime.endValid,"map-dates":e.mapData,"unsend-dates":e.mapData.unsendDates,"sent-data-list":e.mapData.sentDataList,"record-codes":e.mapData.recordCodes,"sent-record-codes":e.mapData.sentRecordCodes,"schedule-setting":e.scheduleSetting,"show-guided-tour-item":e.showGuidedTourItem},on:{manualModeUpdate:function(t){return e.manualModeUpdate()}}})],1)]),a("div",{staticClass:"part validTime"},[a("div",{staticClass:"title"},[a("h3",[e._v(" "+e._s(e.$t("選擇測驗細節"))+" ")])]),a("div",{staticClass:"valid-time-area"},[a("ValidTimeSetting",{attrs:{"date-time":e.dateTime,"quiz-event":e.quizEvent,"date-list-date":e.dateTime.dateList.dates[0],"valid-data":e.validData},on:{saveDateTime:function(t){return e.saveDateTime()}}})],1),e.showGuidedTourItem?a("div",{staticClass:"guided-tour"},[a("GuidedTourItem",{attrs:{"margin-top":100,height:150,"txt-bottom":-50,"txt-right":-70,title:"選擇測驗有效時間",content:"設定是否在限定的期間內才可以作答"}})],1):e._e()]),a("div",{staticClass:"part btn-area save-btn"},[a("button",{staticClass:"btn",on:{click:e.updateEvent}},[a("i",{staticClass:"fas fa-save"}),a("span",[e._v(e._s(e.$t("儲存測驗")))])]),e.showGuidedTourItem?a("div",{staticClass:"guided-tour"},[a("GuidedTourItem",{attrs:{"margin-top":10,"margin-auto":!0,width:40,height:70,"txt-bottom":-70,label:"",title:"儲存測驗"}})],1):e._e()]),a("div",{staticClass:"btn-area last-page"},[a("BackButton")],1)]):e._e()])},s=[],n=(a("4160"),a("4ec9"),a("d3b7"),a("25f0"),a("3ca3"),a("159b"),a("ddb0"),a("96cf"),a("1da1")),r=a("2b0e"),l=a("cb92"),d=a("20ca"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"valid-time-setting"},[a("label",{staticClass:"mb-3"},[e._v(e._s(e.$t("測驗有效時間")))]),a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input-group mb-2"},[a("label",{staticClass:"valid-time",attrs:{for:"valid-time-start"}},[e._v(e._s(e.$t("開始時間")))]),a("div",{staticClass:"valid-time-item"},[a("div",{staticClass:"radio-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.startValidTimeState,expression:"startValidTimeState"}],attrs:{id:"start-unlimited",type:"radio",name:"start-valid-time",value:"sameTimeSent",checked:""},domProps:{checked:e._q(e.startValidTimeState,"sameTimeSent")},on:{click:function(t){e.startTimeHour=0,e.startTimeMin=0,e.saveValidDateTime()},change:function(t){e.startValidTimeState="sameTimeSent"}}}),e.dateTime.scheduledTime?a("label",{attrs:{for:"start-unlimited"}},[e._v(e._s(e.$t("同發送時間")))]):e._e(),e.dateTime.scheduledTime?e._e():a("label",{attrs:{for:"start-unlimited"}},[e._v(e._s(e.$t("無限制")))])]),a("div",{staticClass:"radio-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.startValidTimeState,expression:"startValidTimeState"}],attrs:{id:"start-after-sent",type:"radio",name:"start-valid-time",value:"afterSent"},domProps:{checked:e._q(e.startValidTimeState,"afterSent")},on:{change:function(t){e.startValidTimeState="afterSent"}}}),e.dateTime.scheduledTime?a("label",{attrs:{for:"start-after-sent"}},["afterSent"!==e.startValidTimeState?a("span",[e._v(e._s(e.$t("設定更多")))]):e._e(),"afterSent"===e.startValidTimeState?a("span",{staticClass:"select-detail"},[e._v(" "+e._s(e.$t("測驗發送後"))+" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.startTimeHour,expression:"startTimeHour"}],attrs:{id:"start-after-hour",name:"start-time"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.startTimeHour=t.target.multiple?a:a[0]},function(t){return e.changeValidTimeData()}]}},e._l(100,(function(t){return a("option",{key:t,domProps:{value:t-1}},[e._v(" "+e._s(t-1)+" ")])})),0),e._v(e._s(e.$t("小時"))+" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.startTimeMin,expression:"startTimeMin"}],attrs:{id:"start-after-minute",name:"start-time"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.startTimeMin=t.target.multiple?a:a[0]},function(t){return e.changeValidTimeData()}]}},e._l(60,(function(t){return a("option",{key:t,domProps:{value:t-1}},[e._v(" "+e._s(t-1)+" ")])})),0),e._v(e._s(e.$t("分鐘"))+" ")]):e._e()]):e._e()])])]),a("div",{staticClass:"input-group mb-2"},[a("label",{staticClass:"valid-time",attrs:{for:"valid-time-end"}},[e._v(e._s(e.$t("結束時間")))]),a("div",{staticClass:"valid-time-item"},[a("div",{staticClass:"radio-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.endValidTimeState,expression:"endValidTimeState"}],attrs:{id:"end-unlimited",type:"radio",name:"end-valid-time",value:"sameTimeSent",checked:""},domProps:{checked:e._q(e.endValidTimeState,"sameTimeSent")},on:{click:function(t){e.endTimeDay=0,e.endTimeHour=0,e.saveValidDateTime()},change:function(t){e.endValidTimeState="sameTimeSent"}}}),a("label",{attrs:{for:"end-unlimited"}},[e._v(e._s(e.$t("無限制")))])]),a("div",{staticClass:"radio-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.endValidTimeState,expression:"endValidTimeState"}],attrs:{id:"end-after-sent",type:"radio",name:"end-valid-time",value:"afterSent"},domProps:{checked:e._q(e.endValidTimeState,"afterSent")},on:{change:function(t){e.endValidTimeState="afterSent"}}}),e.dateTime.scheduledTime?a("label",{attrs:{for:"end-after-sent"}},["afterSent"!==e.endValidTimeState?a("span",[e._v(e._s(e.$t("設定更多")))]):e._e(),"afterSent"===e.endValidTimeState?a("span",{staticClass:"select-detail"},[e._v(" "+e._s(e.$t("測驗發送後"))+" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.endTimeDay,expression:"endTimeDay"}],attrs:{id:"end-after-hour",name:"end-time"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.endTimeDay=t.target.multiple?a:a[0]},function(t){return e.changeValidTimeData()}]}},e._l(61,(function(t){return a("option",{key:t,domProps:{value:t-1}},[e._v(" "+e._s(t-1)+" ")])})),0),e._v(e._s(e.$t("日"))+" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.endTimeHour,expression:"endTimeHour"}],attrs:{id:"end-after-minute",name:"end-time"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.endTimeHour=t.target.multiple?a:a[0]},function(t){return e.changeValidTimeData()}]}},e._l(24,(function(t){return a("option",{key:t,domProps:{value:t-1}},[e._v(" "+e._s(t-1)+" ")])})),0),e._v(e._s(e.$t("小時"))+" ")]):e._e()]):e._e()])])])])])},o=[],c=a("9741"),h=r["default"].extend({components:{},props:{dateListDate:{type:String,default:""},quizEvent:{type:Object,required:!0},dateTime:{type:Object,default:function(){return{startValid:""}}},validData:{type:Object,default:function(){return{}}}},data:function(){return{startValidTimeState:"sameTimeSent",endValidTimeState:"sameTimeSent",startDate:null,startTime:null,endDate:null,endTime:null,startTimeHour:0,startTimeMin:0,endTimeDay:0,endTimeHour:0,scheduleSendDate:null,scheduleSendTime:null}},computed:{workspaceId:function(){return this.$store.state.currentWorkspace.uuid},quizEventId:function(){return this.$store.state.currentQuizEvent.uuid}},watch:{quizEvent:function(){this.initDefaultDate()},dateListDate:function(){this.getScheduleSendTime(),this.saveValidDateTime()}},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.initDefaultDate(),e.dateTime.scheduledTime?(0===e.startTimeHour&&0===e.startTimeMin||(e.startValidTimeState="afterSent"),0===e.endTimeDay&&0===e.endTimeHour||(e.endValidTimeState="afterSent")):(e.startValidTimeState="sameTimeSent",e.endValidTimeState="sameTimeSent");case 2:case"end":return t.stop()}}),t)})))()},methods:{changeValidTimeData:function(){0===this.startTimeHour&&0===this.startTimeMin&&0===this.endTimeDay&&0===this.endTimeHour||this.saveValidDateTime()},getScheduleSendTime:function(){if(this.dateListDate){var e=c["a"].dateTimeStringToTimestamp(this.dateListDate),t=c["a"].getDateStringObject(e/1e3);this.scheduleSendDate=t.date,this.scheduleSendTime=t.time}},initDefaultDate:function(){if(!this.quizEvent)throw new Error("quiz event not ready");this.startTimeHour=this.validData.startTimeHour,this.startTimeMin=this.validData.startTimeMin,this.endTimeDay=this.validData.endTimeDay,this.endTimeHour=this.validData.endTimeHour},saveValidDateTime:function(){if(this.scheduleSendDate&&this.scheduleSendTime){if(0!==this.startTimeHour||0!==this.startTimeMin){var e=c["a"].dateStringsToTimestamp(this.scheduleSendDate,this.scheduleSendTime);e+=36e5*this.startTimeHour+6e4*this.startTimeMin;var t=new Date(e).toISOString();this.dateTime.startValid=t}else this.dateTime.startValid=null;if(0!==this.endTimeDay||0!==this.endTimeHour){var a=c["a"].dateStringsToTimestamp(this.scheduleSendDate,this.scheduleSendTime);a+=864e5*this.endTimeDay+36e5*this.endTimeHour;var i=new Date(a).toISOString();this.dateTime.endValid=i}else this.dateTime.endValid=null}else this.dateTime.startValid=null,this.startDate=this.$t("同發送時間").toString(),this.startTime="",this.dateTime.endValid=null,this.endDate=this.$t("無限制").toString(),this.endTime="",console.log("沒存到scheduleSendTime");this.validData.startTimeHour=this.startTimeHour,this.validData.startTimeMin=this.startTimeMin,this.validData.endTimeDay=this.endTimeDay,this.validData.endTimeHour=this.endTimeHour}}}),m=h,p=(a("6b7e"),a("2877")),v=Object(p["a"])(m,u,o,!1,null,"4bb9a782",null),f=v.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"send-mode-setting"},[a("div",{staticClass:"schedule mt-3"},[a("div",{staticClass:"part input-group mb-3 pl-4"},[a("div",{staticClass:"toggle",on:{click:function(t){e.allowSchedule=!e.allowSchedule}}},[a("label",{staticClass:"toggle-label"},[e._v(e._s(e.$t("開啟排程發送機制")))]),a("toggle-button",{attrs:{color:"#82C7EB",sync:!0,labels:!0},on:{change:e.closeSchedule},model:{value:e.allowSchedule,callback:function(t){e.allowSchedule=t},expression:"allowSchedule"}})],1),e.showGuidedTourItem?a("div",{staticClass:"guided-tour"},[a("GuidedTourItem",{attrs:{"margin-top":-15,height:50,width:30,"txt-bottom":-70,label:"","txt-right":20,title:"設定排程發送模式",content:"開啟可以設定發送時間，關閉則不需設定發送時間"}})],1):e._e()]),e.allowRepeat?e._e():a("div",{staticClass:"part input-group mb-3 pl-4"},[a("div",{staticClass:"toggle code-area"},[a("label",{staticClass:"mr-5 pr-2"},[e._v(e._s(e.$t("發送代碼")))]),0!==e.quizEvent.quizGroups.length?a("div",{staticClass:"code-group"},[e._l(e.quizEvent.timeMap,(function(t,i){return a("div",{key:i,staticClass:"code-item"},[e._v(" "+e._s(e.quizEvent.shortId)+"."+e._s(t.recordCode)+" "),a("span",{staticClass:"copy-code",on:{click:function(a){return e.copyEventCode(e.quizEvent.shortId,t.recordCode)}}},[a("i",{staticClass:"far fa-copy"})])])})),a("span",{staticClass:"remind"},[e._v("("+e._s(e.$t("請確定儲存後再複製"))+")")])],2):e._e(),0===e.quizEvent.quizGroups.length?a("div",{staticClass:"code-group"},[a("div",[e._v(" "+e._s(e.quizEvent.shortId)+" "),a("span",{staticClass:"remind"},[e._v("("+e._s(e.$t("尚未選擇題組"))+")")])])]):e._e()])]),e.allowSchedule?a("div",[a("div",{staticClass:"send-time-setting part"},[a("div",{staticClass:"schedule-date-time mt-3"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input-group mb-2"},[a("label",{attrs:{for:"send-date-start"}},[e.allowRepeat?a("span",[e._v(e._s(e.$t("最新")))]):e._e(),e._v(e._s(e.$t("發送日期")))]),a("div",{staticClass:"dateTimePicker"},[a("vc-date-picker",{attrs:{mode:"scheduledDateTime",is24hr:"",locale:e.$i18n.locale},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.inputValue,s=t.inputEvents;return[a("input",e._g({staticClass:"px-2 py-1 border rounded focus:outline-none focus:border-blue-300",domProps:{value:i}},s))]}}],null,!1,666616994),model:{value:e.scheduledDateTime,callback:function(t){e.scheduledDateTime=t},expression:"scheduledDateTime"}})],1)]),a("div",{staticClass:"input-group mb-2"},[a("label",{attrs:{for:"send-time-start"}},[e._v(e._s(e.$t("發送時間")))]),a("div",{staticClass:"dateTimePicker"},[a("vc-date-picker",{attrs:{mode:"time",is24hr:"",locale:e.$i18n.locale,"minute-increment":5},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.inputValue,s=t.inputEvents;return[a("input",e._g({staticClass:"px-2 py-1 border rounded focus:outline-none focus:border-blue-300",domProps:{value:i}},s))]}}],null,!1,666616994),model:{value:e.scheduledDateTime,callback:function(t){e.scheduledDateTime=t},expression:"scheduledDateTime"}})],1)])])]),e.showGuidedTourItem?a("div",{staticClass:"guided-tour"},[a("GuidedTourItem",{attrs:{"margin-top":20,height:70,width:90,"txt-bottom":-100,"txt-right":-70,title:"設定起始日期",content:"設定此測驗的起始日期，也是最新一個發送日的日期"}})],1):e._e()]),a("div",{staticClass:"repeat-mode part"},[a("div",{staticClass:"input-group"},[a("div",{staticClass:"toggle",on:{click:function(t){e.allowRepeat=!e.allowRepeat}}},[a("label",{staticClass:"toggle-label"},[e._v(e._s(e.$t("週期性推送設定")))]),a("toggle-button",{attrs:{color:"#82C7EB",sync:!0,labels:!0},on:{change:e.setRule},model:{value:e.allowRepeat,callback:function(t){e.allowRepeat=t},expression:"allowRepeat"}})],1),e.allowRepeat&&!e.scheduledDateTime?a("span",{staticClass:"remind"},[e._v(e._s(e.$t("請先設定發送日期")))]):e._e()]),e.allowRepeat?a("div",{staticClass:"repeat-form-area"},[a("div",[a("div",{staticClass:"input-group mt-4"},[a("label",[e._v(e._s(e.$t("週期設定")))]),a("div",{staticClass:"item"},[a("div",{staticClass:"radio-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.repeatPeriod,expression:"repeatPeriod"}],attrs:{id:"repeat-week",type:"radio",name:"repeat-frequency",value:"week",checked:""},domProps:{checked:e._q(e.repeatPeriod,"week")},on:{change:[function(t){e.repeatPeriod="week"},e.setRule]}}),a("label",{attrs:{for:"repeat-week"}},[e._v(e._s(e.$t("週")))])]),a("div",{staticClass:"radio-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.repeatPeriod,expression:"repeatPeriod"}],attrs:{id:"repeat-days",type:"radio",name:"repeat-frequency",value:"days"},domProps:{checked:e._q(e.repeatPeriod,"days")},on:{change:[function(t){e.repeatPeriod="days"},e.setRule]}}),a("label",{attrs:{for:"repeat-days"}},[e._v(e._s(e.$t("日")))])])])]),a("div",{staticClass:"input-group mt-2"},[a("label",[e._v(e._s(e.$t("週期細節")))]),a("div",{staticClass:"item"},[a("div",{staticClass:"radio-input"},["week"===e.repeatPeriod?a("span",{staticClass:"select-detail"},[a("select",{attrs:{id:"repeat-num",name:"repeat-num"}},e._l(1,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(e.$t("每"))+" "+e._s(t)+" "+e._s(e.$t("週"))+" ")])})),0)]):e._e(),"days"===e.repeatPeriod?a("span",{staticClass:"select-detail"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.repeatFrequency,expression:"repeatFrequency"}],attrs:{id:"repeat-num",name:"repeat-num"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.repeatFrequency=t.target.multiple?a:a[0]},e.setRule]}},e._l(6,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(e.$t("每"))+" "+e._s(t)+" "),"days"===e.repeatPeriod?a("span",[e._v(e._s(e.$t("日")))]):e._e()])})),0)]):e._e()])])]),"week"===e.repeatPeriod?a("div",{staticClass:"input-group mt-2"},[a("label",[e._v(e._s(e.$t("週間日期")))]),a("div",{staticClass:"item"},[a("div",{staticClass:"checkbox-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.weeklyScheduledDay,expression:"weeklyScheduledDay"}],attrs:{id:"Monday",type:"checkbox",name:"day",value:"1",checked:""},domProps:{checked:Array.isArray(e.weeklyScheduledDay)?e._i(e.weeklyScheduledDay,"1")>-1:e.weeklyScheduledDay},on:{change:[function(t){var a=e.weeklyScheduledDay,i=t.target,s=!!i.checked;if(Array.isArray(a)){var n="1",r=e._i(a,n);i.checked?r<0&&(e.weeklyScheduledDay=a.concat([n])):r>-1&&(e.weeklyScheduledDay=a.slice(0,r).concat(a.slice(r+1)))}else e.weeklyScheduledDay=s},e.setRule]}}),a("label",{attrs:{for:"Monday"}},[e._v(e._s(e.$t("一")))])]),a("div",{staticClass:"checkbox-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.weeklyScheduledDay,expression:"weeklyScheduledDay"}],attrs:{id:"Tuesday",type:"checkbox",name:"day",value:"2"},domProps:{checked:Array.isArray(e.weeklyScheduledDay)?e._i(e.weeklyScheduledDay,"2")>-1:e.weeklyScheduledDay},on:{change:[function(t){var a=e.weeklyScheduledDay,i=t.target,s=!!i.checked;if(Array.isArray(a)){var n="2",r=e._i(a,n);i.checked?r<0&&(e.weeklyScheduledDay=a.concat([n])):r>-1&&(e.weeklyScheduledDay=a.slice(0,r).concat(a.slice(r+1)))}else e.weeklyScheduledDay=s},e.setRule]}}),a("label",{attrs:{for:"Tuesday"}},[e._v(e._s(e.$t("二")))])]),a("div",{staticClass:"checkbox-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.weeklyScheduledDay,expression:"weeklyScheduledDay"}],attrs:{id:"Wednesday",type:"checkbox",name:"day",value:"3"},domProps:{checked:Array.isArray(e.weeklyScheduledDay)?e._i(e.weeklyScheduledDay,"3")>-1:e.weeklyScheduledDay},on:{change:[function(t){var a=e.weeklyScheduledDay,i=t.target,s=!!i.checked;if(Array.isArray(a)){var n="3",r=e._i(a,n);i.checked?r<0&&(e.weeklyScheduledDay=a.concat([n])):r>-1&&(e.weeklyScheduledDay=a.slice(0,r).concat(a.slice(r+1)))}else e.weeklyScheduledDay=s},e.setRule]}}),a("label",{attrs:{for:"Wednesday"}},[e._v(e._s(e.$t("三")))])]),a("div",{staticClass:"checkbox-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.weeklyScheduledDay,expression:"weeklyScheduledDay"}],attrs:{id:"Thursday",type:"checkbox",name:"day",value:"4"},domProps:{checked:Array.isArray(e.weeklyScheduledDay)?e._i(e.weeklyScheduledDay,"4")>-1:e.weeklyScheduledDay},on:{change:[function(t){var a=e.weeklyScheduledDay,i=t.target,s=!!i.checked;if(Array.isArray(a)){var n="4",r=e._i(a,n);i.checked?r<0&&(e.weeklyScheduledDay=a.concat([n])):r>-1&&(e.weeklyScheduledDay=a.slice(0,r).concat(a.slice(r+1)))}else e.weeklyScheduledDay=s},e.setRule]}}),a("label",{attrs:{for:"Thursday"}},[e._v(e._s(e.$t("四")))])]),a("div",{staticClass:"checkbox-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.weeklyScheduledDay,expression:"weeklyScheduledDay"}],attrs:{id:"Friday",type:"checkbox",name:"day",value:"5"},domProps:{checked:Array.isArray(e.weeklyScheduledDay)?e._i(e.weeklyScheduledDay,"5")>-1:e.weeklyScheduledDay},on:{change:[function(t){var a=e.weeklyScheduledDay,i=t.target,s=!!i.checked;if(Array.isArray(a)){var n="5",r=e._i(a,n);i.checked?r<0&&(e.weeklyScheduledDay=a.concat([n])):r>-1&&(e.weeklyScheduledDay=a.slice(0,r).concat(a.slice(r+1)))}else e.weeklyScheduledDay=s},e.setRule]}}),a("label",{attrs:{for:"Friday"}},[e._v(e._s(e.$t("五")))])]),a("div",{staticClass:"checkbox-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.weeklyScheduledDay,expression:"weeklyScheduledDay"}],attrs:{id:"Saturday",type:"checkbox",name:"day",value:"6"},domProps:{checked:Array.isArray(e.weeklyScheduledDay)?e._i(e.weeklyScheduledDay,"6")>-1:e.weeklyScheduledDay},on:{change:[function(t){var a=e.weeklyScheduledDay,i=t.target,s=!!i.checked;if(Array.isArray(a)){var n="6",r=e._i(a,n);i.checked?r<0&&(e.weeklyScheduledDay=a.concat([n])):r>-1&&(e.weeklyScheduledDay=a.slice(0,r).concat(a.slice(r+1)))}else e.weeklyScheduledDay=s},e.setRule]}}),a("label",{attrs:{for:"Saturday"}},[e._v(e._s(e.$t("六")))])]),a("div",{staticClass:"checkbox-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.weeklyScheduledDay,expression:"weeklyScheduledDay"}],attrs:{id:"Sunday",type:"checkbox",name:"day",value:"0"},domProps:{checked:Array.isArray(e.weeklyScheduledDay)?e._i(e.weeklyScheduledDay,"0")>-1:e.weeklyScheduledDay},on:{change:[function(t){var a=e.weeklyScheduledDay,i=t.target,s=!!i.checked;if(Array.isArray(a)){var n="0",r=e._i(a,n);i.checked?r<0&&(e.weeklyScheduledDay=a.concat([n])):r>-1&&(e.weeklyScheduledDay=a.slice(0,r).concat(a.slice(r+1)))}else e.weeklyScheduledDay=s},e.setRule]}}),a("label",{attrs:{for:"Sunday"}},[e._v(e._s(e.$t("星期日")))])])])]):e._e()]),a("div",{staticClass:"adjust-area input-group mt-4"},[a("label",[e._v(e._s(e.$t("日期調整")))]),a("div",{staticClass:"dateTimePicker"},[a("vc-calendar",{attrs:{attributes:e.attributes,locale:e.$i18n.locale},on:{dayclick:e.onDayClick}})],1)])]):e._e(),e.showGuidedTourItem?a("div",{staticClass:"guided-tour"},[a("GuidedTourItem",{attrs:{"margin-top":0,height:60,width:50,label:"","txt-bottom":-180,"txt-right":40,title:"週期性推送設定",content:"預設開啟週期性推送設定。若關閉週期性推送，當設定多個題組時會於同一日期一次推送。開啟後完成大方向設定，若有個別日期需要調整，再點擊右側日曆微調"}})],1):e._e()]),a("div",{staticClass:"scheduleResult"},[a("div",{staticClass:"eventSettingArea"},[a("ScheduleResult",{attrs:{"sent-data-list":e.sentDataList,"start-valid":e.startValid,"end-valid":e.endValid,"seleted-quiz-groups":e.seletedQuizGroups,"multiple-days":e.multipleDays,"from-reschedule":e.fromReschedule,"schedule-setting":e.scheduleSetting,"allow-repeat":e.allowRepeat,"short-id":e.quizEvent.shortId,"record-codes":e.recordCodes,"sent-record-codes":e.sentRecordCodes},on:{saveScheduleDateTime:function(t){return e.saveScheduleDateTime()},removeDate:e.removeDate}})],1)])]):e._e()])])},g=[],T=(a("99af"),a("c740"),a("a434"),a("b0c0"),a("a9e3"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"schedule-result"},[a("div",{staticClass:"next-infomation"},[a("div",{staticClass:"info latest-event"},[a("div",{staticClass:"title"},[e._v(" "+e._s(e.$t("最近發送測驗資訊"))+"： ")]),e.multipleDays[0]&&e.seletedQuizGroups[0]?a("div",{staticClass:"content"},[a("div",[a("p",{staticClass:"schedule-send-date"},[a("span",{staticClass:"subtitle"},[e._v(e._s(e.$t("最近發送時間"))+"：")]),e._v(" "+e._s(e.displayDateFormat(e.multipleDays[0].date))+" "+e._s(e.displayTimeFormat(e.multipleDays[0].date))+" ")]),a("p",[a("span",{staticClass:"subtitle"},[e._v(e._s(e.$t("有效時間(始)"))+"：")]),e._v(" "+e._s(e.validDate.startDate)+" "+e._s(e.validDate.startTime)+" ")]),a("p",[a("span",{staticClass:"subtitle"},[e._v(e._s(e.$t("有效時間(終)"))+"：")]),e._v(" "+e._s(e.validDate.endDate)+" "+e._s(e.validDate.endTime)+" ")])]),e.seletedQuizGroups?a("div",[a("div",{staticClass:"nextQuizName"},[a("p",{staticClass:"subtitle"},[e._v(" "+e._s(e.$t("題組名稱"))+" ： ")]),e.scheduleSetting.allowRepeat?a("div",[a("p",[e._v(e._s(e.seletedQuizGroups[0].metadata.name))])]):e._e(),e.scheduleSetting.allowRepeat?e._e():a("div",{staticClass:"multipleName"},e._l(e.seletedQuizGroups,(function(t,i){return a("p",{key:i},[e._v(" "+e._s(t.metadata.name)+" ")])})),0)])]):e._e()]):e._e(),e.seletedQuizGroups[0]&&e.multipleDays[0]?e._e():a("div",{staticClass:"content remind text-dark"}),!e.seletedQuizGroups[0]&&e.sentDataList[0]?a("div",{staticClass:"content remind text-dark"},[a("p",[e._v(e._s(e.$t("已完成發送")))])]):e._e()])]),a("div",{staticClass:"infomation-check-area"},[a("div",{staticClass:"info"},[a("div",{staticClass:"group-inline"},[a("div",{staticClass:"title"},[e._v(" "+e._s(e.$t("排程中的發送資訊"))+"： ")]),a("div",{staticClass:"tooltip-area d-none"},[a("i",{staticClass:"fas fa-user-edit exam-icon mr-1"}),a("label",{staticClass:"toggle-label"},[e._v(e._s(e.$t("考試模式")))]),a("Tooltip",{attrs:{icon:"?",text:"開起考試模式將會在「互動貼圖APP」啟動測驗時使用線上監考機制以禁止視窗切換、螢幕錄影截圖及通話"}})],1)]),e.multipleDays[0]&&e.seletedQuizGroups[0]?a("div",{staticClass:"content edit-area"},[a("div",{staticClass:"date"},e._l(e.multipleDays,(function(t,i){return a("p",{key:i},[e._v(" "+e._s(e.displayDateFormat(t.date))+" "+e._s(e.displayTimeFormat(t.date))+" ")])})),0),a("div",{staticClass:"quizName"},[a("handle-draggable",{attrs:{"checked-list":e.seletedQuizGroups,display:"scheduled","multiple-days":e.multipleDays,"short-id":e.shortId,"record-codes":e.recordCodes},on:{removeDate:e.removeDate}})],1)]):e._e(),e.seletedQuizGroups[0]&&e.multipleDays[0]?e._e():a("div",{staticClass:"content remind text-dark"}),!e.seletedQuizGroups[0]&&e.sentDataList[0]?a("div",{staticClass:"content remind text-dark"},[a("p",[e._v(e._s(e.$t("已完成發送")))])]):e._e(),e.multipleDays[0]&&e.seletedQuizGroups[0]&&e.showGuidedTourItem?a("div",{staticClass:"guided-tour"},[a("GuidedTourItem",{attrs:{"margin-top":40,"margin-auto":!0,width:95,height:100,"txt-bottom":-50,label:"",title:"可拖曳、刪除題組及複製題組代碼"}})],1):e._e()]),a("div",{staticClass:"info"},[a("div",{staticClass:"title"},[e._v(" "+e._s(e.$t("已完成的發送資訊"))+"： ")]),a("div",{staticClass:"content sent-area"},e._l(e.correctSequence,(function(t,i){return a("div",{key:i,staticClass:"item"},[a("div",{staticClass:"dateTime"},[a("p",[e._v(" "+e._s(e.displayDateFormat(t.scheduledTime))+" "+e._s(e.displayTimeFormat(t.scheduledTime))+" ")])]),a("div",{staticClass:"quizName"},e._l(t.quizGroup,(function(t,i){return a("p",{key:i},[!1===t.isExamMode?a("span",{staticClass:"exam-mode-icon d-none"},[a("i",{staticClass:"fas fa-user-edit exam-icon"})]):e._e(),e._v(" "+e._s(t.metadata.name)+" ")])})),0),a("div",{staticClass:"ui-btn-right more"},[a("div",[a("b-dropdown",{staticClass:"action-menu",attrs:{variant:"none","no-caret":"","toggle-class":"text-decoration-none",boundary:"window",dropright:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[a("div",{staticClass:"icon-btn"},[a("i",{staticClass:"fas fa-ellipsis-v"})])]},proxy:!0}],null,!0)},[1===t.quizGroup.length?a("b-dropdown-item",{staticClass:"copyCode",on:{click:function(t){return e.copyEventCode(e.sentRecordCodes[i])}}},[a("span",[e._v(e._s(e.$t("複製代碼"))+" "+e._s(e.shortId)+"."+e._s(e.sentRecordCodes[i]))]),a("span",[a("i",{staticClass:"far fa-copy"})])]):e._e(),1===t.quizGroup.length?a("b-dropdown-divider"):e._e(),e.allowRepeat?a("b-dropdown-item",[1!==t.quizGroup.length||e.hasQuiz(t.quizGroup[0].uuid)?e._e():a("div",{staticClass:"resend",on:{click:function(a){return e.openRescheduleModal(t.quizGroup)}}},[a("span",[e._v(e._s(e.$t("重送")))]),a("span",[a("i",{staticClass:"fas fa-undo"})])]),1===t.quizGroup.length&&e.hasQuiz(t.quizGroup[0].uuid)?a("div",[e._v(" "+e._s(e.$t("已在排程中"))+" ")]):e._e(),1!==t.quizGroup.length?a("div",{staticClass:"remind"},[e._v(" * "+e._s(e.$t("週期性推送不接受一次性重送"))+" ")]):e._e()]):e._e(),e.allowRepeat?e._e():a("b-dropdown-item",[a("div",{staticClass:"remind"},[e._v(" * "+e._s(e.$t("僅在週期性推送開啟時適用重送機制"))+" ")])])],1)],1)])])})),0),0===e.sentDataList.length?a("div",{staticClass:"remind text-dark"},[a("p",[e._v(e._s(e.$t("尚未有已完成的發送資訊")))])]):e._e(),0!==e.sentDataList.length&&e.showGuidedTourItem?a("div",{staticClass:"guided-tour"},[a("GuidedTourItem",{attrs:{"margin-top":40,"margin-auto":!0,width:95,height:100,"txt-bottom":-50,label:"*",title:"可複製題組代碼、重送題組"}})],1):e._e()])]),a("RescheduleModal")],1)}),D=[],S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{attrs:{name:"reschedule-modal",transition:"pop-out",width:e.modalWidth,"focus-trap":!0,height:480},on:{"before-open":e.beforeOpen}},[a("div",{staticClass:"context"},[a("div",[a("div",{staticClass:"title"},[e._v(" "+e._s(e.$t("重新安排測驗"))+" ")]),a("div",{staticClass:"send-time-setting"},[a("label",{},[e._v(e._s(e.$t("測驗發送時間"))+"：")]),a("div",{staticClass:"schedule-date-time"},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"input-group mb-2"},[a("label",{attrs:{for:"send-date-start"}},[e._v(e._s(e.$t("發送日期")))]),a("div",{staticClass:"dateTimePicker"},[a("vc-date-picker",{attrs:{mode:"scheduleSend",is24hr:"",locale:e.$i18n.locale},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.inputValue,s=t.inputEvents;return[a("input",e._g({staticClass:"px-2 py-1 border rounded focus:outline-none focus:border-blue-300",domProps:{value:i}},s))]}}]),model:{value:e.scheduleSend,callback:function(t){e.scheduleSend=t},expression:"scheduleSend"}})],1)]),a("div",{staticClass:"input-group mb-2"},[a("label",{attrs:{for:"send-time-start"}},[e._v(e._s(e.$t("發送時間")))]),a("div",{staticClass:"dateTimePicker"},[a("vc-date-picker",{attrs:{mode:"time",is24hr:"",locale:e.$i18n.locale,"minute-increment":5},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.inputValue,s=t.inputEvents;return[a("input",e._g({staticClass:"px-2 py-1 border rounded focus:outline-none focus:border-blue-300",domProps:{value:i}},s))]}}]),model:{value:e.scheduleSend,callback:function(t){e.scheduleSend=t},expression:"scheduleSend"}})],1)])])])]),a("div",{staticClass:"quizGroup"},[a("label",{},[e._v(" "+e._s(e.$t("題組名稱"))+"：")]),a("div",{staticClass:"quizGroupName"},e._l(e.quizGroup,(function(t,i){return a("p",{key:i},[e._v(" "+e._s(t.metadata.name)+" ")])})),0)]),a("div",{staticClass:"quizGroup"},[a("label",{staticClass:"remind"},[e._v("* "+e._s(e.$t("確定重送後若要修改發送時間，請刪除排程中的發送資訊，再次重新安排測驗")))])])]),a("div",{staticClass:"button-set"},[a("button",{attrs:{id:"cencel-btn"},on:{click:e.cencelReschedule}},[e._v(" "+e._s(e.$t("取消"))+" ")]),a("button",{attrs:{id:"reschedule-btn"},on:{click:e.reschedule}},[e._v(" "+e._s(e.$t("確定"))+" ")])])])])},_=[],b=(a("c975"),a("d81d"),656),w=r["default"].extend({data:function(){return{modalWidth:b,scheduleSend:"",quizGroup:[],seletedQuizGroups:[],multipleDays:[],fromReschedule:[]}},computed:{},created:function(){this.modalWidth=window.innerWidth<b?b/2:b},methods:{beforeOpen:function(e){this.quizGroup=e.params.quizGroup,this.seletedQuizGroups=e.params.seletedQuizGroups,this.multipleDays=e.params.multipleDays,this.fromReschedule=e.params.fromReschedule},cencelReschedule:function(){console.log("取消重送"),this.$modal.hide("reschedule-modal"),this.scheduleSend=""},reschedule:function(){if(this.scheduleSend){var e=new Date(this.scheduleSend).toISOString();this.multipleDays.push({id:c["a"].getOnlyDateString(e),date:e}),this.multipleDays.sort((function(e,t){var a=c["a"].dateTimeStringToTimestamp(e.date)-c["a"].dateTimeStringToTimestamp(t.date);return a})),this.fromReschedule[0]=!0,console.log("fromReschedule",this.fromReschedule[0]);var t=this.multipleDays.map((function(e){return e.date})).indexOf(e);this.quizGroup&&this.quizGroup[0]&&this.seletedQuizGroups.splice(t,0,this.quizGroup[0]),console.log("確定重送"),this.$modal.hide("reschedule-modal"),this.scheduleSend=""}}}}),k=w,C=(a("718c"),a("52e1"),Object(p["a"])(k,S,_,!1,null,null,null)),z=C.exports,q=a("8198"),E=a("0e1f"),$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tip"},[a("span",{staticClass:"tip-icon"},[e._v(" "+e._s(e.icon)+" ")]),a("span",{staticClass:"tip-text"},[e._v(" "+e._s(e.text)+" ")])])},G=[],x=r["default"].extend({components:{},props:{icon:{type:String,required:!0,default:""},text:{type:String,required:!0,default:""}},data:function(){return{}},computed:{},methods:{}}),R=x,O=(a("889c"),Object(p["a"])(R,$,G,!1,null,"42418716",null)),I=O.exports,M=r["default"].extend({components:{HandleDraggable:q["a"],RescheduleModal:z,GuidedTourItem:E["a"],Tooltip:I},props:{startValid:{type:String,default:""},endValid:{type:String,default:""},seletedQuizGroups:{type:Array,default:function(){return[]}},scheduleSetting:{type:Object,default:function(){return{}}},multipleDays:{type:Array,default:function(){return[]}},fromReschedule:{type:Array,default:function(){return[]}},sentDataList:{type:Array,default:function(){return[]}},allowRepeat:{type:Boolean,default:!0},shortId:{type:String,default:"",required:!1},recordCodes:{type:Array,default:function(){return[]},required:!1},sentRecordCodes:{type:Array,default:function(){return[]},required:!1}},data:function(){return{validDate:{startDate:this.$t("同發送時間").toString(),startTime:null,endDate:this.$t("無限制").toString(),endTime:null}}},computed:{correctSequence:function(){return this.sentDataList.sort((function(e,t){return e.scheduledTime>t.scheduledTime?1:-1})),this.sentDataList},showGuidedTour:function(){return this.$store.state.showGuidedTour},showGuidedTourItem:function(){return!(!this.showGuidedTour||"/manager/quizevent-maker"!==this.$route.path)}},watch:{startValid:function(){this.init()},endValid:function(){this.init()},seletedQuizGroups:function(){this.$emit("saveScheduleDateTime")}},mounted:function(){this.init()},methods:{copyEventCode:function(e){if(!this.shortId)throw new Error("quiz event not ready");var t="".concat(this.shortId,".").concat(e);"none"===e&&(t="".concat(this.shortId)),this.$copyText(t).then((function(e){console.log(t)}),(function(e){console.error("複製失败",e.text)}))},removeDate:function(e){this.$emit("removeDate",e)},hasQuiz:function(e){var t=!1;return this.seletedQuizGroups.forEach((function(a){e===a.uuid&&(t=!0)})),t},init:function(){if(this.startValid||this.endValid){if(this.startValid){var e=c["a"].dateTimeStringToTimestamp(this.startValid),t=c["a"].getDateStringObject(e/1e3);this.validDate.startDate=t.date,this.validDate.startTime=t.time}else this.validDate.startDate=this.$t("同發送時間").toString(),this.validDate.startTime=null;if(this.endValid){var a=c["a"].dateTimeStringToTimestamp(this.endValid),i=c["a"].getDateStringObject(a/1e3);this.validDate.endDate=i.date,this.validDate.endTime=i.time}else this.validDate.endDate=this.$t("無限制").toString(),this.validDate.endTime=null}else this.validDate.startDate=this.$t("同發送時間").toString(),this.validDate.startTime=null,this.validDate.endDate=this.$t("無限制").toString(),this.validDate.endTime=null},openRescheduleModal:function(e){this.$modal.show("reschedule-modal",{quizGroup:e,seletedQuizGroups:this.seletedQuizGroups,multipleDays:this.multipleDays,fromReschedule:this.fromReschedule})},displayDateFormat:function(e){var t=c["a"].getOnlyDateString(e);return t},displayTimeFormat:function(e){var t=new Date(e).getTime(),a=c["a"].getDateStringObject(t/1e3);return a.time}}}),L=M,V=(a("59f4"),Object(p["a"])(L,T,D,!1,null,"1d8451b7",null)),A=V.exports,P=r["default"].extend({components:{ScheduleResult:A,GuidedTourItem:E["a"]},props:{quizEvent:{type:Object,required:!0},dateTime:{type:Object,default:function(){return{scheduledTime:""}}},seletedQuizGroups:{type:Array,default:function(){return[]}},scheduleSetting:{type:Object,default:function(){return{}}},scheduledTime:{type:String,default:""},startValid:{type:String,default:""},endValid:{type:String,default:""},unsendDates:{type:Array,default:function(){return[]}},sentDataList:{type:Array,default:function(){return[]}},showGuidedTourItem:{type:Boolean,default:!1},recordCodes:{type:Array,default:function(){return[]}},sentRecordCodes:{type:Array,default:function(){return[]},required:!1}},data:function(){return{multipleDays:[],allowSchedule:!0,allowRepeat:!0,repeatPeriod:"week",repeatFrequency:1,weeklyScheduledDay:["1"],scheduledDateTime:null,scheduledSendDate:null,scheduledSendTime:null,fromReschedule:[!1]}},computed:{correctSequence:function(){var e=[];return this.sentDataList.forEach((function(t){e.push(t)})),e.sort((function(e,t){return e.scheduledTime>t.scheduledTime?1:-1})),e},seletedDates:function(){var e=[];return this.multipleDays.forEach((function(t){e.push(t.date)})),e},attributes:function(){for(var e=[],t=0;t<this.seletedDates.length;t+=1)if(0===t){var a="";a=this.seletedQuizGroups[t]?this.seletedQuizGroups[t].metadata.name:"---",e.push({highlight:{color:"red",fillMode:"solid"},dates:this.seletedDates[t],popover:{label:a}})}else{var i="",s={};this.seletedQuizGroups[t]?(i=this.seletedQuizGroups[t].metadata.name,s={color:"blue",fillMode:"solid"}):(i="---",s={color:"blue",fillMode:"outline"}),e.push({highlight:s,dates:this.seletedDates[t],popover:{label:i}})}return e},workspaceId:function(){return this.$store.state.currentWorkspace.uuid},quizEventId:function(){return this.$store.state.currentQuizEvent.uuid}},watch:{seletedDates:function(){this.saveScheduleDateTime()},scheduledDateTime:function(){this.allowSchedule&&!this.scheduledDateTime&&(this.allowRepeat=!0),this.setInitDateList(),this.watchInitDatePosition(),this.calendarQuantityRule(!1)},quizEvent:function(){this.initDefaultDate()},seletedQuizGroups:function(){0===this.seletedQuizGroups.length&&(this.allowRepeat=!0),this.calendarQuantityRule(!1)}},mounted:function(){var e,t,a,i=this;(this.initDefaultDate(),this.checkRepeatAllow(),this.unsendDates&&this.unsendDates.forEach((function(e){i.multipleDays.push({id:c["a"].getOnlyDateString(e),date:e})})),this.allowRepeat=this.scheduleSetting.allowRepeat,this.repeatPeriod=this.scheduleSetting.repeatPeriod,this.repeatFrequency=this.scheduleSetting.repeatFrequency,this.weeklyScheduledDay=this.scheduleSetting.weeklyScheduledDay,null===(e=this.quizEvent)||void 0===e?void 0:e.quizGroups)&&((null===(t=this.quizEvent)||void 0===t||null===(a=t.quizGroups)||void 0===a?void 0:a.length)>0&&!this.dateTime.scheduledTime&&(this.allowRepeat=!1,this.allowSchedule=!1))},methods:{copyEventCode:function(e,t){if(!e)throw new Error("quiz event not ready");var a="".concat(e,".").concat(t);t||(a=e),this.$copyText(a).then((function(e){console.log(a)}),(function(e){console.error("複製失败",e.text)}))},closeSchedule:function(){this.allowRepeat&&(this.allowRepeat=!1),this.scheduledDateTime=""},setRule:function(){this.checkRepeatAllow()&&this.makeRuleList("scheduledDateTime")},calendarQuantityRule:function(e){if(!1===this.fromReschedule[0]&&this.allowRepeat&&this.multipleDays.length>0)if(this.seletedQuizGroups.length>this.multipleDays.length)this.checkRepeatAllow()&&this.makeRuleList(this.multipleDays[this.multipleDays.length-1].date);else{if(!e){var t=0;this.attributes.forEach((function(e){"---"===e.popover.label&&(t+=1)})),this.multipleDays.splice(this.multipleDays.length-t,t)}console.log("有多的日期 已刪掉")}},removeDate:function(e){this.seletedQuizGroups.splice(e,1),this.multipleDays.splice(e,1),this.multipleDays[0]?this.scheduledDateTime=this.multipleDays[0].date:this.scheduledDateTime=""},onDayClick:function(e){var t=e.date;if(this.scheduledSendTime){var a=c["a"].dateTimeStringToTimestamp(e.date),i=c["a"].getDateStringObject(a/1e3).date;t=c["a"].toISODateTime(i,this.scheduledSendTime)}var s=this.multipleDays.findIndex((function(t){return t.id===e.id}));if(s>=0?this.multipleDays.splice(s,1):this.multipleDays.push({id:e.id,date:t}),this.multipleDays.sort((function(e,t){var a=c["a"].dateTimeStringToTimestamp(e.date)-c["a"].dateTimeStringToTimestamp(t.date);return a})),this.scheduledDateTime){var n=new Date(c["a"].dateTimeStringToTimestamp(this.scheduledDateTime)).toISOString();if(n!==this.seletedDates[0]){var r=this.seletedDates[0];this.scheduledDateTime=r}}this.calendarQuantityRule(!0),this.saveScheduleDateTime()},initDefaultDate:function(){if(!this.quizEvent)throw new Error("quiz event not ready");if(this.dateTime.scheduledTime){var e=c["a"].dateTimeStringToTimestamp(this.dateTime.scheduledTime);this.scheduledDateTime=new Date(e).toISOString()}else this.scheduledDateTime=""},getScheduleSendDateTime:function(){if(this.scheduledDateTime){var e=c["a"].dateTimeStringToTimestamp(this.scheduledDateTime),t=c["a"].getDateStringObject(e/1e3);this.scheduledSendDate=t.date,this.scheduledSendTime=t.time}},checkRepeatAllow:function(){var e=!1;return this.allowRepeat&&this.scheduledDateTime?(this.repeatPeriod||(this.repeatPeriod="week",this.repeatFrequency=1,this.weeklyScheduledDay=["1"]),"week"===this.repeatPeriod&&(this.repeatFrequency=1,this.weeklyScheduledDay&&0!==this.weeklyScheduledDay.length||(this.weeklyScheduledDay=["1"]),e=!0),"days"===this.repeatPeriod&&(this.weeklyScheduledDay=["1"],e=!0)):(this.multipleDays=[],this.setInitDateList(),this.repeatPeriod="week",this.repeatFrequency=1,this.weeklyScheduledDay=["1"]),e},makeRuleList:function(e){var t=this;this.scheduledDateTime&&function(){var a=0;"scheduledDateTime"===e?(a=c["a"].dateTimeStringToTimestamp(t.scheduledDateTime)/1e3,t.multipleDays=[],t.setInitDateList()):a=c["a"].dateTimeStringToTimestamp(e)/1e3;var i=a,s=a,n="";if("week"===t.repeatPeriod){var r=function(){i+=86400;var e=c["a"].getWeekDay(i);t.weeklyScheduledDay.forEach((function(a){if(e===Number(a)&&(n=c["a"].getOnlyDateString(c["a"].timestampToDateStringFormat(i)),t.scheduledSendTime)){var s=c["a"].toISODateTime(n,t.scheduledSendTime);t.multipleDays.push({id:c["a"].getOnlyDateString(s),date:s})}}))};while(t.seletedQuizGroups.length>t.multipleDays.length)r()}if("days"===t.repeatPeriod)while(t.seletedQuizGroups.length>t.multipleDays.length)if(s+=86400*t.repeatFrequency,n=c["a"].getOnlyDateString(c["a"].timestampToDateStringFormat(s)),t.scheduledSendTime){var l=c["a"].toISODateTime(n,t.scheduledSendTime);t.multipleDays.push({id:c["a"].getOnlyDateString(l),date:l})}t.saveScheduleDateTime()}()},watchInitDatePosition:function(){var e=this;if(this.scheduledDateTime&&this.multipleDays[1]){var t=c["a"].dateTimeStringToTimestamp(this.scheduledDateTime),a=c["a"].dateTimeStringToTimestamp(this.multipleDays[1].date);if(a<=t&&(console.log("會重整"),this.makeRuleList("scheduledDateTime")),!1===this.fromReschedule[0]&&this.scheduledSendDate===c["a"].getOnlyDateString(this.scheduledDateTime)&&this.scheduledSendTime!==c["a"].getDateStringObject(t).time){var i=[];this.multipleDays.forEach((function(t){if(e.scheduledSendTime){var a=c["a"].getOnlyDateString(t.date),s=c["a"].toISODateTime(a,e.scheduledSendTime);i.push({id:a,date:s})}})),this.multipleDays=[],this.multipleDays=i}}},setInitDateList:function(){var e=this;if(this.scheduledDateTime){if(this.getScheduleSendDateTime(),this.scheduledDateTime&&this.scheduledSendTime){var t=c["a"].getOnlyDateString(this.scheduledDateTime),a=c["a"].toISODateTime(t,this.scheduledSendTime),i={id:t,date:a};this.multipleDays[0]?this.multipleDays.forEach((function(a){var s=c["a"].getOnlyDateString(a.date),n=c["a"].dateTimeStringToTimestamp(a.date),r=c["a"].getDateStringObject(n).time;s===t?e.scheduledSendTime!==r&&e.multipleDays.splice(0,1,i):e.multipleDays.splice(0,1,i)})):this.multipleDays.push(i)}}else this.multipleDays=[];this.saveScheduleDateTime()},saveScheduleDateTime:function(){if(this.scheduledSendTime&&this.seletedDates[0]){var e=this.seletedDates[0];this.dateTime.scheduledTime=e,this.dateTime.dateList.dates=this.seletedDates,this.scheduleSetting.allowRepeat=this.allowRepeat,this.scheduleSetting.repeatPeriod=this.repeatPeriod,this.scheduleSetting.repeatFrequency=this.repeatFrequency,this.scheduleSetting.weeklyScheduledDay=this.weeklyScheduledDay}else this.dateTime.scheduledTime=null,this.dateTime.dateList.dates=[],this.scheduleSetting.allowRepeat=!0,this.scheduleSetting.repeatPeriod="week",this.scheduleSetting.repeatFrequency=1,this.scheduleSetting.weeklyScheduledDay=["1"]}}}),Q=P,N=(a("d4e6"),Object(p["a"])(Q,y,g,!1,null,"24f10ffc",null)),j=N.exports,H=a("643a"),F=a("b468"),W=a("aa73"),B=a("9619"),U=a("5870"),J=a("18ad"),K=a("74c9"),X=a("60c8"),Y=a("4523"),Z=r["default"].extend({components:{GuidedTour:H["a"],OpenGuidedTourBtn:F["a"],GuidedTourItem:E["a"],SendModeSetting:j,checkedItems:d["a"],ValidTimeSetting:f,SelectQuizGroupModal:B["a"],SelectMemberGroupModal:U["a"],BackButton:K["a"]},data:function(){return{quizEvent:null,nowTimestamp:Math.floor(new Date(Math.floor(Date.now())).getTime()/1e3),memberGroupsInfo:{name:"member",checkedList:[]},quizGroupsInfo:{name:"quiz",checkedList:[]},dateTime:{scheduledTime:"",startValid:"",endValid:"",dateList:{dates:[]}},mapData:{unsendDates:[]||!1,expiredDates:[],sentDataList:[],recordCodes:[],sentRecordCodes:[]},scheduleSetting:{allowRepeat:!0,repeatPeriod:"week",repeatFrequency:1,weeklyScheduledDay:["1"]},validData:{startTimeHour:0,startTimeMin:0,endTimeDay:0,endTimeHour:0},pushedQuizGroups:[],timeMap:new Map,monitorMap:new Map,saveSignalTimeoutId:0}},computed:{isLoading:function(){return this.$store.state.isLoading},workspaceId:function(){return this.$store.state.currentWorkspace.uuid},quizEventId:function(){return this.$store.state.currentQuizEvent.uuid},showGuidedTour:function(){return this.$store.state.showGuidedTour},showGuidedTourItem:function(){return!(!this.showGuidedTour||"/manager/quizevent-maker"!==this.$route.path)}},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return W["a"].loginCheck(),e.$store.commit("updateLoading",!0),t.prev=2,t.next=5,l["a"].getQuizEvent(e.quizEventId).then(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.quizEvent=a,e.getQuizEventData(),console.log("quizEvent:",a),e.getPushedRecord(),e.getTimeMapData();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:return t.prev=5,e.$store.commit("updateLoading",!1),t.finish(5);case 8:case"end":return t.stop()}}),t,null,[[2,,5,8]])})))()},methods:{setShowGuidedTour:function(e){this.$store.commit("updateGuidedTour",e)},getPushedRecord:function(){var e=this;this.quizEvent&&this.quizEvent.pushedQuizGroupList[0]&&this.quizEvent.pushedQuizGroupList.forEach(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){var i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=[],a.groupId.forEach((function(e){var t=X["a"].retrieve(e);i.push(t)})),t.next=4,Promise.all(i);case 4:s=t.sent,n={},n={quizGroup:s,scheduledTime:a.scheduledTime,recordCode:a.recordCode},e.mapData.sentDataList.push(n),e.quizEvent&&e.mapData.sentDataList.length===e.quizEvent.pushedQuizGroupList.length&&(e.mapData.sentDataList.sort((function(e,t){var a=e.scheduledTime,i=t.scheduledTime;return a<i?-1:a>i?1:0})),e.mapData.sentDataList.forEach((function(t){e.mapData.sentRecordCodes.push(t.recordCode)}))),e.mapData.sentDataList=Y["a"].getSentExamData(e.quizEvent,e.mapData);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},getQuizEventData:function(){this.quizEvent&&(this.scheduleSetting.allowRepeat=!this.quizEvent.onePush,this.scheduleSetting.repeatPeriod=this.quizEvent.period,this.scheduleSetting.weeklyScheduledDay=this.quizEvent.weekdays,this.quizEvent.quizGroups&&this.quizEvent.memberGroups&&0===this.quizEvent.quizGroups.length&&0===this.quizEvent.memberGroups.length&&(this.scheduleSetting.allowRepeat=!0),this.quizEvent.validData&&(this.validData=this.quizEvent.validData),this.quizEvent.frequency&&(this.scheduleSetting.repeatFrequency=this.quizEvent.frequency),this.quizEvent.scheduledTime&&(this.dateTime.scheduledTime=this.quizEvent.scheduledTime),this.quizEvent.startTime&&(this.dateTime.startValid=this.quizEvent.startTime),this.quizEvent.endTime&&(this.dateTime.endValid=this.quizEvent.endTime))},getTimeMapData:function(){if(this.$store.commit("updateLoading",!0),this.quizEvent&&this.quizEvent.timeMap){var e=Y["a"].getMapData(this.quizEvent);this.mapData=e.mapData,this.scheduleSetting=e.scheduleSetting,this.quizEvent=Y["a"].getExamData(this.quizEvent)}this.$store.commit("updateLoading",!1)},getValidDateTime:function(e){var t={startValid:"",endValid:""};if(0!==this.validData.startTimeHour||0!==this.validData.startTimeMin){var a=c["a"].dateTimeStringToTimestamp(e);a+=36e5*this.validData.startTimeHour+6e4*this.validData.startTimeMin;var i=new Date(a).toISOString();t.startValid=i}else t.startValid=null;if(0!==this.validData.endTimeDay||0!==this.validData.endTimeHour){var s=c["a"].dateTimeStringToTimestamp(e);s+=864e5*this.validData.endTimeDay+36e5*this.validData.endTimeHour;var n=new Date(s).toISOString();t.endValid=n}else t.endValid=null;return t},setTimeMap:function(){if(this.quizEvent&&this.quizEvent.quizGroups){var e=this.quizEvent.quizGroups,t=this.dateTime.dateList.dates;if(t.length>0&&0===e.length)throw this.$notify({type:"error",title:this.$t("錯誤").toString(),text:this.$t("有選時間，尚未選擇題組").toString()}),this.$store.commit("updateLoading",!1),console.log("有選時間，尚未選擇題組");if(e.length>0&&0===t.length&&console.log("有選題組，尚未選擇日期，現在後端過不了不能存"),this.timeMap=new Map,0===e.length&&0===t.length)console.log("沒有dateList也沒有quizList",t.length,e.length),this.quizEvent.timeMap=null;else{if(t.length>1)for(var a=0;a<e.length;a+=1){var i=this.getValidDateTime(t[a]).startValid,s=this.getValidDateTime(t[a]).endValid;this.timeMap.set(e[a].uuid,{startTime:i,endTime:s,scheduledTime:t[a],duration:0,recordCode:null})}else{var n=this.getValidDateTime(t[0]).startValid,r=this.getValidDateTime(t[0]).endValid;this.timeMap.set(e[0].uuid,{startTime:n,endTime:r,scheduledTime:t[0],duration:0,recordCode:null})}for(var l=Object.create(null),d=this.timeMap.keys(),u=0;u<this.timeMap.size;u+=1){var o=d.next().value;l[o]=this.timeMap.get(o)}this.quizEvent.timeMap=JSON.parse(JSON.stringify(l))}console.log("timeMap:",this.quizEvent.timeMap)}},setMonitorMap:function(){var e=this;if(this.quizEvent&&this.quizEvent.quizGroups){this.monitorMap=new Map,this.quizEvent.quizGroups.forEach((function(t){!0===t.isExamMode?e.monitorMap.set(t.uuid,{noScreenshot:!0,noSwitchApp:!0,noPhoneCall:!0}):e.monitorMap.set(t.uuid,{noScreenshot:!1,noSwitchApp:!1,noPhoneCall:!1})}));for(var t=Object.create(null),a=this.monitorMap.keys(),i=0;i<this.monitorMap.size;i+=1){var s=a.next().value;t[s]=this.monitorMap.get(s)}this.quizEvent.monitorMap=JSON.parse(JSON.stringify(t)),console.log("monitorMap:",this.quizEvent.monitorMap)}},updateEvent:function(){var e=this;if(!this.quizEvent)throw new Error("quiz event not ready");if(this.$store.commit("updateLoading",!0),!this.quizEvent.quizGroups||!this.quizEvent.memberGroups)throw this.$store.commit("updateLoading",!1),console.log("TimeMap is not ready");if(this.setTimeMap(),!this.quizEvent.quizGroups||!this.quizEvent.memberGroups)throw this.$store.commit("updateLoading",!1),console.log("MonitorMap is not ready");if(this.setMonitorMap(),this.quizEvent.validData=this.validData,1===this.quizEvent.quizGroups.length&&this.dateTime.scheduledTime?this.quizEvent.onePush=!0:this.quizEvent.quizGroups.length>0&&!this.dateTime.scheduledTime?(this.quizEvent.onePush=!0,console.log("有題目但無發送時間，就將onePush開啟")):this.quizEvent.onePush=!this.scheduleSetting.allowRepeat,this.quizEvent.period=this.scheduleSetting.repeatPeriod,this.quizEvent.frequency=this.scheduleSetting.repeatFrequency,this.quizEvent.weekdays=this.scheduleSetting.weeklyScheduledDay,0===this.quizEvent.memberGroups.length)throw this.$notify({type:"error",title:this.$t("錯誤").toString(),text:this.$t("未選擇班級").toString()}),this.$store.commit("updateLoading",!1),console.log("未選擇班級");if(!1===this.quizEvent.onePush&&"week"===this.quizEvent.period&&0===this.quizEvent.weekdays.length)throw this.$notify({type:"error",title:this.$t("錯誤").toString(),text:this.$t("週間日期不得不選").toString()}),this.$store.commit("updateLoading",!1),console.log("this.quizEvent.weekdays不得為0");if(c["a"].dateTimeStringToTimestamp(this.dateTime.scheduledTime)/1e3<this.nowTimestamp)throw this.$notify({type:"error",title:this.$t("錯誤").toString(),text:this.$t("發送時間小於現在").toString()}),this.$store.commit("updateLoading",!1),console.log("發送時間小於現在");console.log("請檢查:",this.quizEvent),l["a"].update(this.quizEventId,this.quizEvent).then((function(){console.log("儲存成功"),e.$notify({type:"success",title:e.$t("成功").toString(),text:e.$t("儲存成功").toString()}),window.location.reload(),e.$store.commit("updateLoading",!1)})).catch((function(e){console.error("update儲存出錯囉",e)})).finally((function(){e.$store.commit("updateLoading",!1)}))},openSelectMemberGroupModal:function(){var e;this.$modal.show("select-member-group-modal",{defaultSelection:null===(e=this.quizEvent)||void 0===e?void 0:e.memberGroups})},updateSelectedMemberGroup:function(e){if(!this.quizEvent)throw new Error("quiz event not ready");this.quizEvent.memberGroups=e},openSelectQuizGroupModal:function(){var e;this.$modal.show("select-quiz-group-modal",{defaultSelection:null===(e=this.quizEvent)||void 0===e?void 0:e.quizGroups,displaySelectAllToggle:!0})},updateSelectedQuizGroup:function(e){if(!this.quizEvent)throw new Error("quiz event not ready");e.length,1===e.length&&(e[0].metadata.type===J["a"].SoftLink&&e[0].sourceObject.metadata.type!==J["a"].QuizGroup?console.log("selection等於1"):e[0].metadata.type!==J["a"].QuizGroup&&console.log("selection等於1，是SoftLink")),this.quizEvent.quizGroups=e}}}),ee=Z,te=(a("443e"),Object(p["a"])(ee,i,s,!1,null,"3a7efb8a",null));t["default"]=te.exports},"6b7e":function(e,t,a){"use strict";var i=a("4c77"),s=a.n(i);s.a},"718c":function(e,t,a){"use strict";var i=a("3a11"),s=a.n(i);s.a},"74c9":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a",{on:{click:function(t){return t.preventDefault(),e.$router.go(-1)}}},[a("i",{staticClass:"fas fa-arrow-left mr-1"}),e._v(" "+e._s(e.$t("上一頁"))+" ")])},s=[],n=(a("79b4"),a("2877")),r={},l=Object(n["a"])(r,i,s,!1,null,"40b0db68",null);t["a"]=l.exports},"79b4":function(e,t,a){"use strict";var i=a("406b"),s=a.n(i);s.a},8198:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.checkedList?a("div",[a("draggable",{staticClass:"list-group",class:{scheduled:"scheduled"===e.display},attrs:{tag:"ul",list:e.checkedList,handle:".handle"}},e._l(e.checkedList,(function(t,i){return a("div",{key:i,staticClass:"item"},[a("div",{staticClass:"item-area",class:{"info-highlight":t.isExamMode}},[a("i",{staticClass:"fa fa-align-justify handle"}),a("div",{staticClass:"index"},[e._v(" "+e._s(i+1)+" ")]),t.metadata?a("div",{staticClass:"info"},["WorkspaceQuizGroup"===t.metadata.type?a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[e._v(" "+e._s(t.metadata.name)+" ")]),a("div",{staticClass:"number"},[e._v(" "+e._s(e.$tc("n題",t.quizNumber,{n:t.quizNumber}))+" ")])]):e._e(),"WorkspaceFolder"===t.metadata.type?a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[e._v(" "+e._s(t.metadata.name)+" ")]),a("div",{staticClass:"number"},[e._v(" "+e._s(e.$t("資料夾"))+" ")])]):e._e(),"WorkspaceSoftLink"===t.metadata.type?a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[e._v(" "+e._s(t.sourceObject.metadata.name)+" "),a("i",{staticClass:"fas fa-user-friends shared-item"})]),a("div",{staticClass:"number"},[e._v(" "+e._s(e.$tc("n題",t.sourceObject.quizNumber,{n:t.sourceObject.quizNumber}))+" ")])]):e._e()]):a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[e._v(" "+e._s(t)+" ")])]),"scheduled"!==e.display?a("i",{staticClass:"fa fa-times close",on:{click:function(t){return e.removeCheckedList(i)}}}):e._e(),"scheduled"===e.display?a("div",{staticClass:"ui-btn-right icon-area"},[a("div",{staticClass:"action-icon"},[a("i",{staticClass:"fas fa-user-edit exam-icon d-none",class:{helpful:e.helpfulData,"icon-highlight":t.isExamMode},on:{click:function(a){return e.setExamMode(t)}}})]),a("div",{staticClass:"action-icon"},[a("b-dropdown",{staticClass:"action-menu",attrs:{variant:"none","no-caret":"","toggle-class":"text-decoration-none",boundary:"window",dropright:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[a("div",{staticClass:"icon-btn"},[a("i",{staticClass:"fas fa-ellipsis-v"})])]},proxy:!0}],null,!0)},[!e.recordCodes[i]&&e.multipleDays.length>1?a("b-dropdown-item",[e._v(" "+e._s(e.$t("複製代碼請先儲存測驗"))+" ")]):e._e(),e.recordCodes[i]&&e.multipleDays.length>1?a("b-dropdown-item",{staticClass:"copyCode",on:{click:function(t){return e.copyEventCode(e.recordCodes[i])}}},[a("span",[e._v(e._s(e.$t("複製代碼"))+" "+e._s(e.shortId)+"."+e._s(e.recordCodes[i]))]),a("span",[a("i",{staticClass:"far fa-copy"})])]):e._e(),e.recordCodes[i]&&e.multipleDays.length>1?a("b-dropdown-divider"):e._e(),a("b-dropdown-item",{staticClass:"removeBtn",on:{click:function(t){return e.removeAt(i)}}},[a("p",[e._v(e._s(e.$t("移除"))),a("i",{staticClass:"fa fa-times"})])])],1)],1)]):e._e()])])})),0)],1):e._e()},s=[],n=(a("99af"),a("a434"),a("b76a")),r=a.n(n),l={name:"Handle",display:"Handle",components:{draggable:r.a},props:{checkedList:{type:Array,default:function(){return[]}},mapData:{type:Object,default:function(){return{}}},display:{type:String,default:"",required:!1},multipleDays:{type:Array,default:function(){return[]},required:!1},shortId:{type:String,default:"",required:!1},recordCodes:{type:Array,default:function(){return[]},required:!1}},data:function(){return{helpfulData:!1}},computed:{},methods:{setExamMode:function(e){e.isExamMode=!e.isExamMode,this.helpfulData=!this.helpfulData},removeCheckedList:function(e){this.checkedList.splice(e,1)},removeAt:function(e){this.$emit("removeDate",e),console.log(e)},copyEventCode:function(e){if(!this.shortId)throw new Error("quiz event not ready");var t="".concat(this.shortId,".").concat(e);this.$copyText(t).then((function(e){console.log(t)}),(function(e){console.error("複製失败",e.text)}))}}},d=l,u=(a("0786"),a("2877")),o=Object(u["a"])(d,i,s,!1,null,"4a05373c",null);t["a"]=o.exports},"87ca":function(e,t,a){"use strict";var i=a("d281"),s=a.n(i);s.a},"889c":function(e,t,a){"use strict";var i=a("ce12"),s=a.n(i);s.a},9619:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{staticClass:"modal-container",attrs:{name:"select-quiz-group-modal",transition:"pop-out",width:"640","focus-trap":!0,height:"640"},on:{"before-open":e.beforeOpen}},[e.quizLocalRootId&&e.quizShareRootId?a("WorkspaceObjectSelector",{attrs:{"local-root-id":e.quizLocalRootId,"share-root-id":e.quizShareRootId,"default-selection":e.defaultSelection,"local-root-name":e.$t(e.rootName),"allow-select-many":!0,"is-quiz-unit-on":e.isQuizUnitOn,"display-select-all-toggle":e.displaySelectAllToggle},on:{"submit-selection":e.handleSubmit,cancel:e.handleCancel}}):a("loading",{attrs:{active:!0,"is-full-page":!1,"background-color":"transparent"}})],1)},s=[],n=a("2b0e"),r=a("5da8"),l=n["default"].extend({components:{WorkspaceObjectSelector:r["a"]},data:function(){return{defaultSelection:[],rootName:"我的題庫",isQuizUnitOn:!1,displaySelectAllToggle:!1}},computed:{quizLocalRootId:function(){return this.$store.state.currentWorkspace?this.$store.state.currentWorkspace.quizFolders.local:null},quizShareRootId:function(){return this.$store.state.currentWorkspace?this.$store.state.currentWorkspace.quizFolders.share:null}},methods:{beforeOpen:function(e){e.params.isQuizUnitOn&&(this.isQuizUnitOn=e.params.isQuizUnitOn),e.params.displaySelectAllToggle&&(this.displaySelectAllToggle=e.params.displaySelectAllToggle),e.params.defaultSelection&&!this.isQuizUnitOn&&(this.defaultSelection=e.params.defaultSelection)},handleSubmit:function(e){this.$emit("submit-selection",e),this.$modal.hide("select-quiz-group-modal")},handleCancel:function(){this.$modal.hide("select-quiz-group-modal")}}}),d=l,u=a("2877"),o=Object(u["a"])(d,i,s,!1,null,null,null);t["a"]=o.exports},af88:function(e,t,a){},b468:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"open-guided-tour-btn",on:{click:e.openGuidedTour}},[a("i",{staticClass:"far fa-lightbulb"})])},s=[],n=a("2b0e"),r=n["default"].extend({components:{},props:{},data:function(){return{}},computed:{},methods:{openGuidedTour:function(){this.$emit("setShowGuidedTour",!0)}}}),l=r,d=(a("4442"),a("2877")),u=Object(d["a"])(l,i,s,!1,null,"6046357f",null);t["a"]=u.exports},b771:function(e,t,a){"use strict";var i=a("fa74"),s=a.n(i);s.a},cb92:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));a("b0c0");var i,s=a("5530"),n=(a("96cf"),a("1da1")),r=a("d4ec"),l=a("bee2"),d=a("6ad1");(function(e){e["INIT"]="INIT",e["SCHEDULED"]="SCHEDULED",e["RUNNING"]="RUNNING",e["DONE"]="DONE",e["CANCELED"]="CANCELED",e["TERMINATED"]="TERMINATED",e["ERROR"]="ERROR"})(i||(i={}));var u=function e(t,a,i,s,n,l,d,u,o,c,h,m,p){if(Object(r["a"])(this,e),t&&(this.name=t),null!==l&&(this.timeMap=l),null!==d&&(this.monitorMap=d),null!==u&&(this.onePush=u),null!==c&&(this.period=c),s){this.quizGroupIdList=[];for(var v=0;v<s.length;v+=1)this.quizGroupIdList.push(s[v].uuid)}if(n){this.memberGroupIdList=[];for(var f=0;f<n.length;f+=1)this.memberGroupIdList.push(n[f].uuid)}null!==h&&(this.validData=h),null!==m&&(this.frequency=m),null!==p&&(this.weekdays=p),null!==a&&(this.allowRetake=a),null!==i&&(this.shuffle=i),null!==o&&(this.eyeballDetect=o)},o=a("88c3"),c=function(){function e(){Object(r["a"])(this,e)}return Object(l["a"])(e,null,[{key:"create",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={parentId:t,name:o["a"].t("未命名測驗")},e.next=3,d["a"].post("workspace/quiz-events/",a);case 3:return i=e.sent,e.abrupt("return",i.data.quizEvent);case 5:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getQuizEvent",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d["a"].get("workspace/quiz-events/".concat(t));case 2:return a=e.sent,e.abrupt("return",a.data.quizEvent);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getQuizEventState",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d["a"].get("workspace/quiz-events/".concat(t,"/state"));case 2:return a=e.sent,e.abrupt("return",a.data.quizEventState);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,a){var i,n,r,l,o,c,h,m,p,v,f,y,g,T,D;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=a.metadata,n=a.quizGroups,r=a.allowRetake,l=a.shuffle,o=a.memberGroups,c=a.timeMap,h=a.onePush,m=a.eyeballDetect,p=a.period,v=a.validData,f=a.frequency,y=a.weekdays,g=a.monitorMap,T=new u(i.name,r,l,n,o,c,g,h,m,p,v,f,y),D=Object(s["a"])({},T),e.next=5,d["a"].put("workspace/quiz-events/".concat(t),D);case 5:case"end":return e.stop()}}),e)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"sendNow",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d["a"].post("workspace/quiz-events/".concat(t,"/send"),{});case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}()},cdfa:function(e,t,a){},ce12:function(e,t,a){},d281:function(e,t,a){},d4e6:function(e,t,a){"use strict";var i=a("cdfa"),s=a.n(i);s.a},d81d:function(e,t,a){"use strict";var i=a("23e7"),s=a("b727").map,n=a("1dde"),r=a("ae40"),l=n("map"),d=r("map");i({target:"Array",proto:!0,forced:!l||!d},{map:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},dc93:function(e,t,a){},fa74:function(e,t,a){}}]);
//# sourceMappingURL=chunk-69c0dcf9.507f2fd8.js.map