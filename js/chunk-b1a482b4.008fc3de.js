(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b1a482b4"],{"076e":function(e,t,i){"use strict";var n=i("689f"),r=i.n(n);r.a},"150d":function(e,t,i){"use strict";var n=i("4ac9"),r=i.n(n);r.a},"4ac9":function(e,t,i){},"5da8":function(e,t,i){"use strict";var n,r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"selector"},[i("div",{staticClass:"main-area"},[e.isMemberUnitOn?e._e():i("div",{staticClass:"root-navigator",class:{"d-none":e.shareGroupHidden}},[i("b-button",{staticClass:"btn",on:{click:function(t){return t.preventDefault(),e.visitFolder(e.localRootId)}}},[e._v(" "+e._s(e.localRootName)+" ")]),i("b-button",{staticClass:"btn",on:{click:function(t){return t.preventDefault(),e.visitFolder(e.shareRootId)}}},[e._v(" "+e._s(e.$t("與我共用"))+" ")])],1),e.currentFolder?i("div",{staticClass:"folder-browser"},[i("div",{staticClass:"current-folder"},[e.isMemberUnitOn?i("div"):e._e(),e.currentFolder&&!e.isMemberUnitOn?i("Breadcrumb",{attrs:{path:e.currentFolder.path,situation:"objectSelector"},on:{visitFolder:e.visitFolder}}):e._e(),i("div",{staticClass:"cancel-btn"},[i("i",{staticClass:"fas fa-times py-3",on:{click:function(t){return t.preventDefault(),e.$emit("cancel")}}})])],1),e.currentQuizFile&&!e.isMemberUnitOn?i("div",{staticClass:"quiz-unit-selector"},e._l(e.currentQuizFile.quizList,(function(t,n){return i("div",{key:t.uuid},[i("QuizUnitSelector",{attrs:{"workspace-object":t,"default-selected":e.selectionSet.has(t.uuid),"allow-select-many":e.allowSelectMany,selection:e.selection,"select-mode-open":e.selectModeOpen,index:n},on:{visitFolder:e.visitFolder,visitFile:e.visitFile,toggle:function(i){return e.toggleSelection(t)}}})],1)})),0):e._e(),e.currentQuizFile||e.isMemberUnitOn?e._e():i("div",{staticClass:"input-group"},[e._m(0),i("input",{directives:[{name:"model",rawName:"v-model",value:e.searchString,expression:"searchString"}],staticClass:"form-control",attrs:{id:"search",type:"text",placeholder:e.$t("搜尋名稱")},domProps:{value:e.searchString},on:{input:function(t){t.target.composing||(e.searchString=t.target.value)}}}),""!==e.searchString?i("div",{staticClass:"cancel-input",on:{click:function(t){e.searchString=""}}},[i("i",{staticClass:"fas fa-times-circle"})]):e._e()]),e.displaySelectAllToggle?i("div",{staticClass:"selected-filter"},[i("label",{on:{click:e.selectAll}},[e.allSelected?e._e():i("i",{staticClass:"far fa-square"}),e.allSelected?i("i",{staticClass:"fas fa-check-square"}):e._e(),e._v(" 全選 ")])]):e._e(),e.currentQuizFile||e.isMemberUnitOn?e._e():i("div",{staticClass:"select-items"},[0===e.filteredMethodList.length&&""!==e.trimSearchString?i("div",{staticClass:"searchTip mt-5"},[e._v(" "+e._s(e.$t("沒有對應的搜尋結果"))+" ")]):e._e(),i("div",e._l(e.filteredMethodList,(function(t){return i("div",{key:t.uuid},[i("WorkspaceObjectItem",{attrs:{"workspace-object":t,"default-selected":e.selectionSet.has(t.uuid),"allow-select-many":e.allowSelectMany,selection:e.selection,"select-mode-open":e.selectModeOpen,"is-quiz-unit-on":e.isQuizUnitOn},on:{visitFolder:e.visitFolder,visitFile:e.visitFile,toggle:function(i){return e.toggleSelection(t)}}})],1)})),0)]),e.isMemberUnitOn?i("div",{staticClass:"memberUnit-top"},[i("div",{staticClass:"subtitle"},[i("div",[e._v(" "+e._s(e.$t("請選擇與"))+" ")]),i("div",{staticClass:"duplicated-student"},[e._v(" "+e._s(e.duplicatedStudent.name)+" ")]),i("div",[e._v(" "+e._s(e.$t("重複的對象"))+" ")])]),i("div",{staticClass:"input-group"},[e._m(1),i("input",{directives:[{name:"model",rawName:"v-model",value:e.searchString,expression:"searchString"}],staticClass:"form-control",attrs:{id:"search",type:"text",placeholder:e.$t("搜尋名稱")},domProps:{value:e.searchString},on:{input:function(t){t.target.composing||(e.searchString=t.target.value)}}}),""!==e.searchString?i("div",{staticClass:"cancel-input",on:{click:function(t){e.searchString=""}}},[i("i",{staticClass:"fas fa-times-circle"})]):e._e()]),i("div",{staticClass:"table-head"},[i("div",{staticStyle:{width:"50px"}}),i("div",{staticStyle:{width:"200px"}},[e._v(" "+e._s(e.$t("姓名"))+" ")]),i("div",{staticStyle:{width:"150px"}},[e._v(" "+e._s(e.$t("代號"))+" ")]),i("div",{staticStyle:{width:"150px"}},[e._v(" "+e._s(e.$t("成員角色"))+" ")]),i("div",{staticStyle:{width:"50px"}})]),i("div",{staticClass:"searchTip"},[e.memberList.length>0?i("div",[0===e.filteredMemberList.length&&""!==e.trimSearchString?i("div",{staticClass:"mt-5"},[e._v(" "+e._s(e.$t("沒有對應的搜尋結果"))+" ")]):e._e()]):i("div",{staticClass:"mt-5"},[e._v(" "+e._s(e.$t("沒有可重複的對象"))+" ")])])]):e._e(),e.isMemberUnitOn?i("div",{staticClass:"select-items"},e._l(e.filteredMemberList,(function(t,n){return i("div",{key:n},[i("MemberUnitSelector",{attrs:{member:t,"default-selected":e.selectionSet.has(t.uuid),selection:e.selection,"select-mode-open":e.selectModeOpen},on:{toggle:function(i){return e.toggleSelection(t)}}})],1)})),0):e._e()]):e._e()]),i("transition",{attrs:{name:"fade"}},[e.defaultSelection.length>0|e.selection.length>0?i("div",{staticClass:"buttons"},[i("b-button",{on:{click:function(t){return t.preventDefault(),e.$emit("submit-selection",e.selection)}}},[e._v(" "+e._s(e.$t("確認"))+" "),e.allowSelectMany?i("span",[e._v(" ("+e._s(e.selection.length)+") ")]):e._e()])],1):e._e()]),e.isLoading?i("div",[i("loading",{attrs:{active:e.isLoading,"is-full-page":!1,"background-color":"transparent"},on:{"update:active":function(t){e.isLoading=t}}})],1):e._e()],1)},a=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"input-group-prepend"},[i("label",{staticClass:"input-group-text",attrs:{for:"search"}},[i("i",{staticClass:"fas fa-search"})])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"input-group-prepend"},[i("label",{staticClass:"input-group-text",attrs:{for:"search"}},[i("i",{staticClass:"fas fa-search"})])])}],s=(i("4de4"),i("c740"),i("4160"),i("c975"),i("a434"),i("b0c0"),i("d3b7"),i("25f0"),i("6062b"),i("3ca3"),i("498a"),i("159b"),i("ddb0"),i("96cf"),i("1da1")),c=i("3bb2"),l=i("18ad"),o=i("8eb5"),u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"item",on:{click:function(t){return t.preventDefault(),e.clickItemToggle(t)}}},[i("div",{staticClass:"quiz-list"},[e.allowSelectMany?i("div",[e.selectModeOpen?i("div",{staticClass:"button-area"},[i("div",[e._v(e._s(e.index+1)+".")]),e.selected?i("i",{staticClass:"fas fa-check-circle",staticStyle:{color:"green"}}):i("i",{staticClass:"far fa-circle"})]):e._e()]):e._e(),i("div",{staticClass:"quiz-img"},[i("img",{attrs:{src:e.workspaceObject.previewImage.url,alt:e.index}})])])])},d=[],f=(i("a9e3"),i("2b0e")),p=f["default"].extend({components:{},props:{workspaceObject:{type:Object,required:!0},defaultSelected:{type:Boolean,required:!0},allowSelectMany:{type:Boolean,default:!1},selection:{type:Array,required:!0},selectModeOpen:{type:Boolean,default:!1},index:{type:Number,default:0}},data:function(){return{selected:!1}},computed:{},watch:{},methods:{clickItemToggle:function(){this.selectModeOpen&&(this.selected=!this.selected,this.$emit("toggle"))}}}),m=p,h=(i("150d"),i("2877")),v=Object(h["a"])(m,u,d,!1,null,"f2603a18",null),b=v.exports,g=i("b47d"),S=i("010d"),_=i("67c0"),y=i("60c8"),w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"item",on:{click:function(t){return t.preventDefault(),e.clickItemToggle(t)}}},[e._m(0),i("div",{staticClass:"member-name",staticStyle:{width:"200px"}},[e._v(" "+e._s(e.member.name)+" ")]),i("div",{staticStyle:{width:"150px"}},[e._v(" "+e._s(e.member.businessDefinedId)+" ")]),i("div",{staticStyle:{width:"150px"}},[e.member.role===e.MemberRole.STUDENT?i("span",[e._v(e._s(e.$t("一般學生")))]):e._e(),e.member.role===e.MemberRole.TEACHER?i("span",[e._v(e._s(e.$t("老師")))]):e._e(),e.member.role===e.MemberRole.STUDENT_DUPLICATED?i("span",[e._v(e._s(e.$t("重複學生")))]):e._e(),e.member.role===e.MemberRole.STUDENT_EXEMPTED?i("span",[e._v(e._s(e.$t("特例學生")))]):e._e()]),e.selectModeOpen?i("div",{staticClass:"button-area",staticStyle:{width:"50px"}},[e.selected?i("i",{staticClass:"fas fa-check-circle",staticStyle:{color:"green"}}):i("i",{staticClass:"far fa-circle"})]):e._e()])},C=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{width:"50px"}},[i("i",{staticClass:"fas fa-user"})])}];(function(e){e["STUDENT"]="STUDENT",e["TEACHER"]="TEACHER",e["STUDENT_DUPLICATED"]="STUDENT_DUPLICATED",e["STUDENT_EXEMPTED"]="STUDENT_EXEMPTED"})(n||(n={}));var k=f["default"].extend({components:{},props:{member:{type:Object,required:!0},defaultSelected:{type:Boolean,required:!0},selection:{type:Array,required:!0},selectModeOpen:{type:Boolean,default:!1}},data:function(){return{MemberRole:n,selected:!1}},computed:{},watch:{},mounted:function(){var e=this;this.selected=this.defaultSelected,g["c"].$on("reset",(function(){e.selected=e.defaultSelected}))},methods:{clickItemToggle:function(){this.selectModeOpen&&(this.selected=!this.selected,this.$emit("toggle"))}}}),x=k,O=(i("71cf"),Object(h["a"])(x,w,C,!1,null,"4f9a94e7",null)),M=O.exports,F=f["default"].extend({name:"WorkspaceObjectSelector",components:{WorkspaceObjectItem:o["a"],Breadcrumb:S["a"],QuizUnitSelector:b,MemberUnitSelector:M},props:{localRootId:{type:String,required:!0},shareRootId:{type:String,required:!0},localRootName:{type:String,required:!0},allowSelectMany:{type:Boolean,default:!1},defaultSelection:{type:Array,default:function(){return[]}},isQuizUnitOn:{type:Boolean,default:!1},isMemberUnitOn:{type:Boolean,default:!1},shareGroupHidden:{type:Boolean,default:!1},duplicatedStudent:{type:Object,default:function(){return{uuid:"",name:""}}},memberList:{type:Array,default:function(){return[]}},displaySelectAllToggle:{type:Boolean,default:!1}},data:function(){return{selectModeOpen:!0,WorkspaceObjectType:l["a"],selection:[],selectionSet:new Set,currentFolder:null,currentQuizFile:null,isLoading:!1,searchString:"",allSelected:!1}},computed:{allFiles:function(){return this.workspaceObjects.filter((function(e){return e.metadata.type!==l["a"].Folder}))},workspaceObjects:function(){if(this.currentFolder&&!this.isMemberUnitOn){var e=new Intl.Collator("en",{numeric:!0,sensitivity:"base"}),t=this.currentFolder.children.filter((function(e){return e.metadata.type!==l["a"].Folder})),i=this.currentFolder.children.filter((function(e){return e.metadata.type===l["a"].Folder})),n=this.currentFolder.children.filter((function(e){return e.metadata.type===l["a"].SoftLink}));if(n=n.filter((function(e){return e.sourceObject})),n.length>0)return n.sort((function(t,i){return e.compare(t.sourceObject.metadata.name.toUpperCase().trim(),i.sourceObject.metadata.name.toUpperCase().trim())}));t.sort((function(t,i){return e.compare(t.metadata.name.toUpperCase().trim(),i.metadata.name.toUpperCase().trim())})),i.sort((function(t,i){return e.compare(t.metadata.name.toUpperCase().trim(),i.metadata.name.toUpperCase().trim())}));var r=[];return i.forEach((function(e){r.push(e)})),t.forEach((function(e){r.push(e)})),r}return[]},searchList:function(){var e=this,t=[];return this.workspaceObjects.forEach((function(i){var n=i.metadata.name,r=e.trimSearchString(e.searchString),a=n.toUpperCase().indexOf(r.toUpperCase());a>=0&&t.push(i)})),t},filteredMethodList:function(){var e=this.trimSearchString(this.searchString);return""!==e?this.searchList:this.workspaceObjects},searchMemberList:function(){var e=this,t=[];return this.memberList.forEach((function(i){var n=i.name,r=e.trimSearchString(e.searchString),a=n.toUpperCase().indexOf(r.toUpperCase());a>=0&&t.push(i)})),t},filteredMemberList:function(){var e=this.trimSearchString(this.searchString);return""!==e?this.searchMemberList:this.memberList}},mounted:function(){var e=this;this.defaultSelection&&(this.selection=_["a"].deepcopy(this.defaultSelection)),this.selection.forEach((function(t){e.selectionSet.add(t.uuid)})),this.visitFolder(this.localRootId),this.duplicatedStudent&&(this.searchString=this.duplicatedStudent.name)},methods:{checkAllSelected:function(){if(this.allFiles.length>0){for(var e=0,t=0;t<this.allFiles.length;t+=1){var i=this.allFiles[t],n=this.selectionSet.has(i.uuid);n||(e+=1)}this.allSelected=0===e}},selectAll:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var i,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.allSelected)for(n=function(t){var i=e.selection.findIndex((function(i){return i.uuid===e.allFiles[t].uuid}));-1!==i&&e.selection.splice(i,1),e.selectionSet.delete(e.allFiles[t].uuid)},r=0;r<e.allFiles.length;r+=1)n(r);else for(i=0;i<e.allFiles.length;i+=1)e.selectionSet.has(e.allFiles[i].uuid)||(e.selection.push(e.allFiles[i]),e.selectionSet.add(e.allFiles[i].uuid));return t.next=3,e.$nextTick();case 3:g["c"].$emit("reset"),e.checkAllSelected();case 5:case"end":return t.stop()}}),t)})))()},trimSearchString:function(e){return e.trim()},visitFolder:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t.isLoading=!0,i.prev=1,t.currentQuizFile=null,i.next=5,c["a"].retrieve(e);case 5:t.currentFolder=i.sent,t.checkAllSelected(),i.next=13;break;case 9:i.prev=9,i.t0=i["catch"](1),console.error(i.t0),t.$notify({type:"error",title:t.$t("錯誤").toString(),text:t.$t("讀取資料夾失敗，請稍後重試").toString()});case 13:return i.prev=13,t.isLoading=!1,i.finish(13);case 16:case"end":return i.stop()}}),i,null,[[1,9,13,16]])})))()},visitFile:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(t.isLoading=!0,i.prev=1,!t.isQuizUnitOn){i.next=6;break}return i.next=5,y["a"].retrieve(e);case 5:t.currentQuizFile=i.sent;case 6:i.next=12;break;case 8:i.prev=8,i.t0=i["catch"](1),console.error(i.t0),t.$notify({type:"error",title:t.$t("錯誤").toString(),text:t.$t("讀取資料夾失敗，請稍後重試").toString()});case 12:return i.prev=12,t.isLoading=!1,i.finish(12);case 15:case"end":return i.stop()}}),i,null,[[1,8,12,15]])})))()},toggleSelection:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){var n;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=t.selection.findIndex((function(t){return t.uuid===e.uuid})),-1!==n){i.next=11;break}if(t.allowSelectMany||(t.selection=[],t.selectionSet=new Set),t.selection.push(e),t.selectionSet.add(e.uuid),t.allowSelectMany){i.next=9;break}return i.next=8,t.$nextTick();case 8:g["c"].$emit("reset");case 9:i.next=13;break;case 11:t.selection.splice(n,1),t.selectionSet.delete(e.uuid);case 13:t.checkAllSelected();case 14:case"end":return i.stop()}}),i)})))()}}}),U=F,E=(i("076e"),Object(h["a"])(U,r,a,!1,null,"3edd884c",null));t["a"]=E.exports},"6062b":function(e,t,i){"use strict";var n=i("6d61"),r=i("6566");e.exports=n("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},"67c0":function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));i("d3b7"),i("25f0");var n=i("6b75");function r(e){if(Array.isArray(e))return Object(n["a"])(e)}i("a4d3"),i("e01a"),i("d28b"),i("a630"),i("3ca3"),i("ddb0");function a(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var s=i("06c5");function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return r(e)||a(e)||Object(s["a"])(e)||c()}i("96cf");var o=i("1da1"),u=i("d4ec"),d=i("bee2"),f=function(){function e(){Object(u["a"])(this,e)}return Object(d["a"])(e,null,[{key:"deepcopy",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"randomString",value:function(e){return e<0?"":Math.random().toString(36).substring(e)}},{key:"preloadImage",value:function(e){return new Promise((function(t,i){var n=new Image;n.onload=function(){t()},n.onerror=function(){i(new Error("Failed to load image from ".concat(e)))},n.src=e}))}},{key:"demo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;return new Promise((function(t,i){var n=Math.random();n>e?t(n):i(new Error("less than ".concat(e)))}))}},{key:"wait",value:function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))}},{key:"retry",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(i,n){var r,a,s,c,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=o.length>2&&void 0!==o[2]?o[2]:5,a=o.length>3&&void 0!==o[3]?o[3]:100,r=Math.max(r,0),a=Math.max(a,10),s=null,c=0;case 6:if(!(c<r)){t.next=21;break}return t.prev=7,t.next=10,i.apply(void 0,l(n));case 10:return t.abrupt("return",t.sent);case 13:t.prev=13,t.t0=t["catch"](7),s=t.t0;case 16:return t.next=18,e.wait(a);case 18:c+=1,t.next=6;break;case 21:throw s;case 22:case"end":return t.stop()}}),t,null,[[7,13]])})));function i(e,i){return t.apply(this,arguments)}return i}()},{key:"fileToDataUrl",value:function(e){return new Promise((function(t,i){var n=new FileReader;n.onload=function(e){if(e&&e.target&&"string"===typeof e.target.result){var n=e.target.result;t(n)}else i(new Error("Failed to read file as dataUrl"))},n.readAsDataURL(e)}))}},{key:"getCanvasBlob",value:function(e){return new Promise((function(t,i){e.toBlob((function(e){null===e?i(new Error("Unable to convert canvas to blob")):t(e)}),"image/png")}))}}]),e}()},"689f":function(e,t,i){},"71cf":function(e,t,i){"use strict";var n=i("b9ad"),r=i.n(n);r.a},b9ad:function(e,t,i){}}]);
//# sourceMappingURL=chunk-b1a482b4.008fc3de.js.map